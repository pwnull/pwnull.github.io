

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/ico.png">
  <link rel="icon" href="/img/ico.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="pwnull">
  <meta name="keywords" content="">
  
    <meta name="description" content="ååºåˆ—åŒ–æ¼æ´ä¸€ç›´å æ®ç€JAVAå®‰å…¨çš„åŠå£æ±Ÿå±±ï¼Œæ˜¯æ¯ä¸ªJAVAå®‰å…¨ç ”ç©¶è€…éƒ½ç»•ä¸å¼€çš„å¤§å±±ä¹‹ä¸€ã€‚ä»15å¹´è¢« @frohoff and @gebl å…¬å¸ƒåˆ©ç”¨åˆ°ç°åœ¨è¿‘8å¹´çš„æ—¶é—´ï¼Œååºåˆ—åŒ–æ¼æ´åœ¨Oracle&amp;#x2F;Apache&amp;#x2F;vmware&amp;#x2F;IBM&amp;#x2F;å›½äº§ç­‰ä¼—å¤šå‚å•†çš„ç³»ç»Ÿã€ç»„ä»¶ã€ä¸­é—´ä»¶ä¸­è‚†è™æ¨ªè¡Œã€‚ç¬”è€…åœ¨ä¹‹å‰æ–‡ç« åˆ†æçš„JNDI&amp;#x2F;RMI&amp;#x2F;JMXç­‰å‡ä¸æ­¤å®‰å…¨é—®é¢˜æœ‰">
  
  
  
  <title>é™æ€ä»£ç æ‰«æå·¥å…·ä¹‹GadgetInspectoræ¢ç©¶ - è¿›é˜¶çš„èƒ–é—¹-pwnull</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"pwnull.github.io","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"left","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>è¿›é˜¶çš„èƒ–é—¹-pwnull</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="é™æ€ä»£ç æ‰«æå·¥å…·ä¹‹GadgetInspectoræ¢ç©¶"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-02-28 10:00" pubdate>
          2023-02-28
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          21k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          <!-- compatible with older versions-->
          173 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="padding-left: 2rem; margin-right: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">é™æ€ä»£ç æ‰«æå·¥å…·ä¹‹GadgetInspectoræ¢ç©¶</h1>
            
            
              <div class="markdown-body">
                
                <p>ååºåˆ—åŒ–æ¼æ´ä¸€ç›´å æ®ç€JAVAå®‰å…¨çš„åŠå£æ±Ÿå±±ï¼Œæ˜¯æ¯ä¸ªJAVAå®‰å…¨ç ”ç©¶è€…éƒ½ç»•ä¸å¼€çš„å¤§å±±ä¹‹ä¸€ã€‚ä»15å¹´è¢« <a target="_blank" rel="noopener" href="https://twitter.com/frohoff">@frohoff</a> and <a target="_blank" rel="noopener" href="https://twitter.com/gebl">@gebl</a> å…¬å¸ƒåˆ©ç”¨åˆ°ç°åœ¨è¿‘8å¹´çš„æ—¶é—´ï¼Œååºåˆ—åŒ–æ¼æ´åœ¨Oracle&#x2F;Apache&#x2F;vmware&#x2F;IBM&#x2F;å›½äº§ç­‰ä¼—å¤šå‚å•†çš„ç³»ç»Ÿã€ç»„ä»¶ã€ä¸­é—´ä»¶ä¸­è‚†è™æ¨ªè¡Œã€‚ç¬”è€…åœ¨ä¹‹å‰æ–‡ç« åˆ†æçš„JNDI&#x2F;RMI&#x2F;JMXç­‰å‡ä¸æ­¤å®‰å…¨é—®é¢˜æœ‰åƒä¸ä¸‡ç¼•çš„å…³ç³»ã€‚é“¾æ¥ç›´è¾¾ï¼š</p>
<p><a href="https://pwnull.github.io/2022/How-to-attack-RMI-based-JMX-services/"> Attack JMX Serviceçš„æ‰“å¼€æ–¹å¼ </a></p>
<p><a href="https://pwnull.github.io/2022/Exploring-JAVA-RMI's-offensive-and-defensive-history/">è®ºJAVA-RMIçš„æ”»é˜²æ¼”è¿›å²</a></p>
<p><a href="https://pwnull.github.io/2022/jndi-injection-history/">å½“æˆ‘ä»¬è°ˆè®ºJNDIæ³¨å…¥æ—¶ï¼Œæˆ‘ä»¬åœ¨è°ˆè®ºä»€ä¹ˆ</a></p>
<p>ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨çš„å…¥å£æ–¹æ³•sourceåŠæœ€ç»ˆæ¼æ´è§¦å‘æ–¹æ³•sinkéƒ½å®¹æ˜“ç¡®å®šï¼Œè€Œå¯»æ‰¾è¿æ¥å…¥å£æ–¹æ³•åˆ°æ¼æ´è§¦å‘æ–¹æ³•ä¸­é—´çš„åˆ©ç”¨é“¾è·¯æ‰æ˜¯æŒ–æ˜ä¸åˆ©ç”¨çš„é‡ç‚¹ã€‚åœ¨æ—¥å¸¸çš„å®¡è®¡æŒ–æ˜è¿‡ç¨‹ä¸­ï¼Œæ—¥ç›Šæ„Ÿè§‰ysoserialã€marshalsecä¸­ç°å­˜çš„åˆ©ç”¨é“¾å¹¶ä¸èƒ½ç™¾å‘ç™¾ä¸­ï¼Œå¾ˆå¤šæ—¶å€™éƒ½éœ€è¦æˆ‘ä»¬æ ¹æ®ç°æœ‰ç¯å¢ƒå¯»æ‰¾æ–°çš„åˆ©ç”¨é“¾ã€‚åœ¨å¯»æ‰¾è¿‡ç¨‹ä¸­ä¹Ÿéå¸¸è€ƒéªŒæŒ–æ˜è€…çš„çŸ¥è¯†å‚¨å¤‡ä¸è€å¿ƒã€‚é‚£æœ‰æ²¡æœ‰ä¸€æ¬¾è‡ªåŠ¨åŒ–&#x2F;åŠè‡ªåŠ¨åŒ–çš„å·¥å…·å¯ä»¥è¾…åŠ©æˆ‘ä»¬å»å¯»æ‰¾å‘¢ï¼Ÿä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒIan Hakenåœ¨18å¹´çš„blackhatå¤§ä¼šæ¨å‡ºäº†ä¸€æ¬¾è‡ªç ”æ‰«æå·¥å…· GadgetInspectorï¼Œå…³äºè¯¥æ¬¾å·¥å…·çš„åŸæ–‡ä»‹ç»ã€æºç åŠè§†é¢‘å¦‚ä¸‹ï¼š</p>
<p>æºç ï¼š<a target="_blank" rel="noopener" href="https://github.com/JackOfMostTrades/gadgetinspector">https://github.com/JackOfMostTrades/gadgetinspector</a></p>
<p>æ–‡ç¨¿ï¼š<a target="_blank" rel="noopener" href="https://i.blackhat.com/us-18/Thu-August-9/us-18-Haken-Automated-Discovery-of-Deserialization-Gadget-Chains.pdf">https://i.blackhat.com/us-18/Thu-August-9/us-18-Haken-Automated-Discovery-of-Deserialization-Gadget-Chains.pdf</a></p>
<p>è§†é¢‘ï¼š<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=fdctNIt8OIw">https://www.youtube.com/watch?v=fdctNIt8OIw</a></p>
<p>åœˆå†…çš„å¸ˆå‚…ä¹Ÿå¯¹æ­¤å·¥å…·åšè¿‡åˆ†æä¸å®Œå–„ï¼Œæœ¬æ–‡ä¹Ÿå‚è€ƒäº†ä¸€äº›å¸ˆå‚…ä»¬çš„æ–‡ç« ï¼Œè‡´æ•¬æ„Ÿè°¢åˆ†äº«ï¼</p>
<p><a target="_blank" rel="noopener" href="https://threedr3am.github.io/2020/01/09/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%A9%E7%94%A8%E9%93%BE%E8%87%AA%E5%8A%A8%E6%8C%96%E6%8E%98%E5%B7%A5%E5%85%B7gadgetinspector%E6%BA%90%E7%A0%81%E6%B5%85%E6%9E%90/">threedr3am-javaååºåˆ—åŒ–åˆ©ç”¨é“¾è‡ªåŠ¨æŒ–æ˜å·¥å…·gadgetinspectoræºç æµ…æ</a></p>
<p><a target="_blank" rel="noopener" href="https://paper.seebug.org/1034/">Longofo-Java ååºåˆ—åŒ–å·¥å…· gadgetinspector åˆçª¥</a></p>
<p><a target="_blank" rel="noopener" href="https://su18.org/post/gadgetor/">su18-é«˜æ•ˆæŒ–æ˜ååºåˆ—åŒ–æ¼æ´â€”â€”GadgetInspectoræ”¹é€ </a></p>
<p>æ•´ä½“æ¥çœ‹ GadgetInspectorå·¥å…·è¿è¡Œæµç¨‹ä¸»è¦ä¸ºå¯¹classpathä¸­å…¨éƒ¨classè¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œç”Ÿæˆæ–¹æ³•å†…ã€æ–¹æ³•é—´çš„æ±¡ç‚¹ä¼ é€’å…³ç³»ï¼Œæœ€ç»ˆæ‰¾åˆ°ä»sourceå¯ä»¥é€šå¾€sinkçš„åˆ©ç”¨é“¾ã€‚å¦å¤–æ‰«æé’ˆå¯¹çš„æ˜¯javaå­—èŠ‚ç ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åˆ†æJaråŒ…&#x2F;WaråŒ…è€Œæ— éœ€é¡¹ç›®javaæºç ã€‚æ•´ä¸ªè¿‡ç¨‹è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼Œå…¶ä¸­æ¶‰åŠåˆ°JAVA ASMæŠ€æœ¯ã€JVMæŒ‡ä»¤ã€é€†æ‹“æ‰‘æ’åºã€è¿›å‡ºæ ˆæ¨¡æ‹Ÿç­‰ç­‰çŸ¥è¯†ã€‚ä¹‹å‰å¯¹è¿™å—å†…å®¹äº†è§£ä¸å¤šï¼Œä¹Ÿæƒ³åšä¸ªæ‰«æå·¥å…·è¾…åŠ©è‡ªå·±åšä¸€äº›åŸºç¡€å®¡è®¡çš„å·¥ä½œï¼Œäº‰å–æ—©æ—¥è§£æ”¾åŒæ‰‹ï¼æœ¬æ–‡ä»æ‰€éœ€çš„å‰ç½®çŸ¥è¯†ã€åˆ†ææ‰«ææµç¨‹ä¸­çš„å…³é”®ç±»åŠå®é™…æµ‹è¯•æ‰«æä¸‰éƒ¨åˆ†å±•å¼€ï¼Œå¦‚æœå¯¹æ–‡ç« æœ‰ç–‘é—®&#x2F;å»ºè®®æˆ–è€…æƒ³ä¸€èµ·ç ”ç©¶äº¤æµçš„å¸ˆå‚…ï¼Œæ¬¢è¿ç§ä¿¡ğŸ˜œ</p>
<h2 id="1ã€å‰ç½®çŸ¥è¯†"><a href="#1ã€å‰ç½®çŸ¥è¯†" class="headerlink" title="1ã€å‰ç½®çŸ¥è¯†"></a>1ã€å‰ç½®çŸ¥è¯†</h2><p>å‰ç½®çŸ¥è¯†éƒ¨åˆ†ä¸»è¦æœ‰æè¿°ç¬¦ã€ASMæŠ€æœ¯åŠJVMç›¸å…³çš„çŸ¥è¯†ã€‚ä¸‡ä¸ˆé«˜æ¥¼å¹³åœ°èµ·ï¼Œæ™“å¾—äº†åŸºç¡€çŸ¥è¯†æ–¹ä¾¿åç»­å±•å¼€åˆ†æ</p>
<h3 id="1-1-æè¿°ç¬¦"><a href="#1-1-æè¿°ç¬¦" class="headerlink" title="1.1 æè¿°ç¬¦"></a>1.1 æè¿°ç¬¦</h3><p>GadgetInspectoræœ€å¼€å§‹å¯¹ç±»ã€æ–¹æ³•ä¿¡æ¯æœé›†é˜¶æ®µä¼šç”¨åˆ°ç±»å‹åŠæ–¹æ³•æè¿°ç¬¦</p>
<p>1ã€ç±»å‹æè¿°ç¬¦ï¼ŒJAVAåŸå§‹ç±»å‹çš„æè¿°ç¬¦å‡å¯¹åº”ä¸€ä¸ªå¤§å†™å­—æ¯ã€‚éæ•°ç»„çš„å¼•ç”¨ç±»å‹ä½¿ç”¨ï¼š<code>L+ç±»å…¨é™å®šåç§°+;</code> ã€æ•°ç»„å¼•ç”¨ç±»å‹ä½¿ç”¨ï¼š<code>[+æ•°ç»„å†…ç±»å‹æè¿°ç¬¦+;</code></p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs xl"><span class="hljs-function"><span class="hljs-title">byte</span> -&gt;</span> B<br><span class="hljs-function"><span class="hljs-title">short</span> -&gt;</span> S<br><span class="hljs-function"><span class="hljs-title">int</span> -&gt;</span> I<br><span class="hljs-function"><span class="hljs-title">long</span> -&gt;</span> J<br><span class="hljs-function"><span class="hljs-title">float</span> -&gt;</span> F<br><span class="hljs-function"><span class="hljs-title">double</span> -&gt;</span> D<br><span class="hljs-function"><span class="hljs-title">char</span> -&gt;</span> C<br><span class="hljs-function"><span class="hljs-title">void</span> -&gt;</span> V<br><span class="hljs-function"><span class="hljs-title">boolean</span> -&gt;</span> Z<br><br><span class="hljs-function"><span class="hljs-title">java</span>.lang.Runtime -&gt;</span> Ljava/lang/Runtime;<br><span class="hljs-function"><span class="hljs-title">java</span>.lang.Object[] -&gt;</span> [java/lang/Object;<br><span class="hljs-function"><span class="hljs-title">int</span>[][] -&gt;</span> [[I<br></code></pre></td></tr></table></figure>

<p>2ã€æ–¹æ³•æè¿°ç¬¦</p>
<p>å­—èŠ‚ç ä¸­ä¿å­˜å‚æ•°ç±»å‹åˆ—è¡¨åŠè¿”å›å€¼ç±»å‹æ—¶ä¼šç”¨åˆ°æ–¹æ³•æè¿°ç¬¦ï¼Œè§„åˆ™ï¼š1ã€æ ¼å¼ä¸º<code>(+å‚æ•°åˆ—è¡¨+)+è¿”å›å€¼;</code>2ã€å‚æ•°åˆ—è¡¨æ— éœ€ç”¨é€—å·åˆ†å‰²</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-built_in">String</span> add<span class="hljs-function"><span class="hljs-params">(int a,int b)</span> -&gt;</span> (II)Ljava/lang/<span class="hljs-built_in">String</span>;<br><span class="hljs-literal">void</span> sub<span class="hljs-function"><span class="hljs-params">(int a,int b)</span> -&gt;</span> (II)V<br>int[] s<span class="hljs-function"><span class="hljs-params">(<span class="hljs-built_in">Object</span> obj)</span> -&gt;</span> (Ljava/lang/<span class="hljs-built_in">Object</span>;)[I<br><span class="hljs-literal">void</span> a<span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span> ()V<br></code></pre></td></tr></table></figure>

<p>3ã€æ–¹æ³• accesså€¼</p>
<p>accesså€¼æ˜¯æŒ‰ç…§æ–¹æ³•çš„ä¿®é¥°ç¬¦å¯¹åº”å€¼åšâ€æŒ‰ä½æˆ–|â€è®¡ç®—å¾—æ¥çš„ï¼Œå¦‚mainå‡½æ•°ä¸ºpublicã€staticä¿®é¥°ï¼Œåˆ™<code>access = ACC_PUBLIC(1) | ACC_STATIC(8) = 9</code>ï¼Œå…·ä½“å¯¹åº”å€¼çš„å®šä¹‰åœ¨org.objectweb.asm.Opcodesç±»ä¸­</p>
<table>
<thead>
<tr>
<th>access</th>
<th>name</th>
<th>desc</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td><init></td>
<td>()V</td>
</tr>
<tr>
<td>9</td>
<td>main</td>
<td>([Ljava&#x2F;lang&#x2F;String;)V</td>
</tr>
</tbody></table>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/1.png" srcset="/img/loading.gif" lazyload></p>
<p><client>æ–¹æ³•ï¼šjavaç±»åŠ è½½åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œä¼šå°†ç±»ä¸­çš„ç±»å˜é‡èµ‹å€¼ã€é™æ€ä»£ç å—ä¸­çš„è¯­å¥é›†åˆä¸º<client>æ–¹æ³•</p>
<h3 id="1-2-ASMæŠ€æœ¯"><a href="#1-2-ASMæŠ€æœ¯" class="headerlink" title="1.2 ASMæŠ€æœ¯"></a>1.2 ASMæŠ€æœ¯</h3><p>GadgetInspectorä¸­ä¸»è¦åˆ©ç”¨äº†ASMçš„è®¿é—®è€…æ¨¡å¼å¯¹ç±»&#x2F;æ–¹æ³•è¿›è¡Œè§‚å¯Ÿæ“ä½œï¼ŒASMå°è£…äº†å¯¹äºclassæ–‡ä»¶ç»“æ„å„é¡¹å…ƒç´ çš„æ“ä½œï¼Œå¯¹ç±»ä½¿ç”¨ClassVisitorå®ç°ç±»è¿›è¡Œè§‚å¯Ÿã€å¯¹æ–¹æ³•ä½¿ç”¨MethodVisitorå®ç°ç±»è¿›è¡Œè§‚å¯Ÿ</p>
<p>ClassVisitor ç”¨äºè§‚å¯Ÿç±»ä¿¡æ¯ï¼ŒGadgetInspectorä¸­ä½¿ç”¨çš„å‡ ä¸ªç±»è§‚å¯Ÿç±»ï¼šMethodDiscoveryClassVisitorã€MethodCallDiscoveryClassVisitorã€PassthroughDataflowClassVisitorã€ModelGeneratorClassVisitorã€‚è¿™äº›ç±»éƒ½ç»§æ‰¿å®ç°äº†çˆ¶ç±»ClassVisitorçš„visitXXXæ–¹æ³•ï¼Œå¦‚ä¸‹æ˜¯æ–¹æ³•åç§°åŠè§¦å‘è°ƒç”¨çš„æ¡ä»¶</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">visit</span> åˆå§‹åŒ–è¢«è§‚å¯Ÿç±»çš„æè¿°ä¿¡æ¯<br>visitField è§‚å¯Ÿåˆ°å±æ€§æ—¶è§¦å‘æ­¤æ–¹æ³•<br>visitMethod è§‚å¯Ÿåˆ°æ–¹æ³•æ—¶è§¦å‘æ­¤æ–¹æ³•<br></code></pre></td></tr></table></figure>

<p>MethodVisitor ç”¨äºè§‚å¯Ÿæ–¹æ³•ä¿¡æ¯ï¼ŒGadgetInspectorä¸­ä½¿ç”¨çš„å‡ ä¸ªæ–¹æ³•è§‚å¯Ÿç±»ï¼šMethodCallDiscoveryMethodVisitorã€PassthroughDataflowMethodVisitorã€ModelGeneratorMethodVisitorã€TaintTrackingMethodVisitorã€‚åœ¨è¿™äº›ç±»ä¸­æ¶‰åŠåˆ°å‡ ä¸ªæ¯”è¾ƒé‡è¦ä¸”é¢‘ç¹è°ƒç”¨çš„visitXXXæ–¹æ³•ï¼Œå¦‚ä¸‹æ˜¯æ–¹æ³•åç§°åŠè§¦å‘è°ƒç”¨çš„æ¡ä»¶</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">visitCode</span> è¿›å…¥æ–¹æ³•æ—¶è§¦å‘<br>visitMethodInsn æ–¹æ³•å†…è°ƒç”¨å­æ–¹æ³•æ—¶è§¦å‘<br>visitInsn ç¢°åˆ°æ— æ“ä½œæ•°æŒ‡ä»¤æ—¶è§¦å‘<br>visitFieldInsn è°ƒç”¨å­—æ®µæ—¶è§¦å‘<br>visitVarInsn æ“ä½œå˜é‡æ—¶è§¦å‘<br></code></pre></td></tr></table></figure>

<p>å¦å¤–å¯ä»¥ä½¿ç”¨IDEAçš„ASM Bytecode Vieweræ’ä»¶æŸ¥çœ‹ç±»å¯¹åº”çš„å­—èŠ‚ç åŠASMä»£ç </p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/2.png" srcset="/img/loading.gif" lazyload></p>
<p>ASMä»£ç </p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/3.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="1-3-JVM"><a href="#1-3-JVM" class="headerlink" title="1.3 JVM"></a>1.3 JVM</h3><p>åœ¨é‡ç‚¹åˆ†æä¸‹èŠ‚å†…å®¹å‰ï¼Œæˆ‘ä»¬å…ˆå¼•å…¥ä¸€äº›JVMä¸­çš„åŸºç¡€æ¦‚å¿µï¼šå˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€JVMæŒ‡ä»¤é›†</p>
<p>æœ¬åœ°å˜é‡è¡¨ <strong>Local Variable Table</strong> ï¼šå­˜å‚¨çš„æ˜¯ æ–¹æ³•å‚æ•°å’Œæ–¹æ³•å†…å®šä¹‰çš„å±€éƒ¨å˜é‡ã€‚å®¹é‡ä»¥ å˜é‡æ§½ Variable Slot ä¸ºæœ€å°å•ä½ï¼Œä¸€ä¸ªæ§½å¯ä»¥æ”¾ç½®32ä½ä»¥å†…çš„æ•°æ®ç±»å‹</p>
<p>æ“ä½œæ•°æ ˆ <strong>Operand Stack</strong> ï¼šæ˜¯ä¸€ä¸ªåå…¥å…ˆå‡ºæ ˆLIFOï¼ˆlast in first outï¼‰ã€‚å½“ä¸€ä¸ªæ–¹æ³•å¼€å§‹æ‰§è¡Œå‰æ“ä½œæ•°æ ˆæ˜¯ç©ºçš„ï¼Œéšç€æ–¹æ³•æ‰§è¡Œï¼Œä¼šä»æœ¬åœ°å˜é‡è¡¨ã€å¯¹è±¡å®ä¾‹å­—æ®µä¸­åŠ è½½å˜é‡&#x2F;å¸¸é‡åˆ°æ“ä½œæ•°æ ˆä¸­ï¼Œä¹Ÿä¼šå°†æ ˆä¸­å…ƒç´ å‡ºæ ˆåˆ°æœ¬åœ°å˜é‡è¡¨æˆ–è¿”å›ç»™æ–¹æ³•è°ƒç”¨è€…ï¼Œå³ä¸ºå‡ºæ ˆå…¥æ ˆæ“ä½œã€‚å½“æ–¹æ³•æ‰§è¡Œå®Œæ¯•ä¸”æœ‰è¿”å›å€¼èµ‹å€¼ç»™å˜é‡æ—¶ï¼Œéœ€è¦é€šè¿‡ [type]store_[n]ç­‰æŒ‡ä»¤å°†å˜é‡(ç±»å‹type)å­˜å…¥æœ¬åœ°å˜é‡è¡¨å¯¹åº”çš„ä½ç½®(ç´¢å¼•n)ã€‚è€Œä¸€æ¬¡æ–¹æ³•çš„æ‰§è¡Œå¾€å¾€åŒ…å«å¤šä¸ªå‡ºæ ˆ&#x2F;å…¥æ ˆçš„è¿‡ç¨‹</p>
<p>JVMæŒ‡ä»¤é›†<strong>Java Virtual Machine Instruction Set</strong>ï¼šç”±æ“ä½œç ä¸æ“ä½œæ•°ç»„æˆï¼Œä¸€æ¡JVMæŒ‡ä»¤å¯ä»¥åŒ…å«0ä¸ªæˆ–å¤šä¸ªæ“ä½œæ•°ã€‚å¤§å¤šæ•°çš„JVMæŒ‡ä»¤ç›´æ¥åŒ…å«äº†æ“ä½œå¯¹åº”çš„æ•°æ®ç±»å‹ä¿¡æ¯ï¼Œæ¯”å¦‚iloadã€floadå°±è¡¨ç¤ºä»æœ¬åœ°å˜é‡è¡¨ä¸­åŠ è½½intæ•°æ®ã€floatæ•°æ®åˆ°æ“ä½œæ•°æ ˆã€‚åœ¨GadgetInspectorå·¥å…·ä¸­ TaintTrackingMethodVisitor#visitInsnå°±æ¨¡æ‹Ÿäº†æ— æ“ä½œæ•°çš„JVMæŒ‡ä»¤æ“ä½œï¼ŒTaintTrackingMethodVisitor#visitIntInsnæ¨¡æ‹Ÿäº†ä¸€ä¸ªæ“ä½œæ•°çš„JVMæŒ‡ä»¤æ“ä½œï¼ˆç¬¬ä¸€ä¸ªintå‚æ•°è¡¨ç¤ºæ“ä½œç ã€ç¬¬äºŒä¸ªè¡¨ç¤ºæ“ä½œæ•°ï¼‰</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/4.png" srcset="/img/loading.gif" lazyload></p>
<p>å„æŒ‡ä»¤ä»£è¡¨çš„å«ä¹‰å¯å‚è€ƒoracleå®˜æ–¹æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/specs/jvms/se19/html/jvms-6.html">https://docs.oracle.com/javase/specs/jvms/se19/html/jvms-6.html</a></p>
<p>æ¯ä¸ªç±»å¯¹åº”çš„jvmæŒ‡ä»¤é›†å¯ä»¥ä½¿ç”¨ideaæ’ä»¶jclasslibå¾ˆæ–¹ä¾¿çš„æŸ¥çœ‹ï¼š<a target="_blank" rel="noopener" href="https://github.com/ingokegel/jclasslib">https://github.com/ingokegel/jclasslib</a>  å¦‚ä½¿ç”¨jclasslibæŸ¥çœ‹java.lang.Runtime#haltæ–¹æ³•çš„æŒ‡ä»¤é›†</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-comment">//source</span><br>public void halt(<span class="hljs-built_in">int</span> status) &#123;<br>    SecurityManager sm = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">System</span>.</span></span>get<span class="hljs-constructor">SecurityManager()</span>;<br>    <span class="hljs-keyword">if</span> (sm != null) &#123;<br>    	sm.check<span class="hljs-constructor">Exit(<span class="hljs-params">status</span>)</span>;<br>    &#125;<br>    <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Shutdown</span>.</span></span>before<span class="hljs-constructor">Halt()</span>;<br>    <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Shutdown</span>.</span></span>halt(status);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯¹åº”çš„JVMæŒ‡ä»¤ï¼š</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs gradle"> <span class="hljs-number">0</span> invokestatic #<span class="hljs-number">203</span> &lt;java<span class="hljs-regexp">/lang/</span>System.getSecurityManager : ()Ljava<span class="hljs-regexp">/lang/</span>SecurityManager;&gt;<br> <span class="hljs-number">3</span> astore_2<br> <span class="hljs-number">4</span> aload_2<br> <span class="hljs-number">5</span> ifnull <span class="hljs-number">13</span> (+<span class="hljs-number">8</span>)<br> <span class="hljs-number">8</span> aload_2<br> <span class="hljs-number">9</span> iload_1<br><span class="hljs-number">10</span> invokevirtual #<span class="hljs-number">191</span> &lt;java<span class="hljs-regexp">/lang/</span>SecurityManager.checkExit : (I)V&gt;<br><span class="hljs-number">13</span> invokestatic #<span class="hljs-number">194</span> &lt;java<span class="hljs-regexp">/lang/</span>Shutdown.beforeHalt : ()V&gt;<br><span class="hljs-number">16</span> iload_1<br><span class="hljs-number">17</span> invokestatic #<span class="hljs-number">196</span> &lt;java<span class="hljs-regexp">/lang/</span>Shutdown.halt : (I)V&gt;<br><span class="hljs-number">20</span> <span class="hljs-keyword">return</span><br><br></code></pre></td></tr></table></figure>

<p>æ–¹æ³•ä½“å†…æ¯è¡Œä»£ç çš„æ“ä½œæŒ‡ä»¤</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/5.png" srcset="/img/loading.gif" lazyload></p>
<p>ç»“åˆä½¿ç”¨æ’ä»¶ASM Bytecode Viewerä¸­çš„ASMä»£ç ã€æ’ä»¶jclasslibç”Ÿæˆçš„JVMæŒ‡ä»¤å°±å¯ä»¥å¾ˆå¥½çš„è¾…åŠ©æˆ‘ä»¬ç†è§£GadgetInspectoræ˜¯å¦‚ä½•åˆ©ç”¨ASMè§‚å¯Ÿè€…æ¨¡å¼ã€JVMæŒ‡ä»¤æ“ä½œã€æ¨¡æ‹Ÿjava stackè¿›å‡ºè¿™äº›æŠ€æœ¯æœ€ç»ˆè¾¾åˆ°æŒ–æ˜åˆ©ç”¨é“¾çš„ç›®çš„çš„</p>
<h2 id="2ã€å…³é”®ç±»"><a href="#2ã€å…³é”®ç±»" class="headerlink" title="2ã€å…³é”®ç±»"></a>2ã€å…³é”®ç±»</h2><p>åœ¨æ•´ä¸ªé¡¹ç›®ä¸­æœ‰ä¸€äº›å…³é”®ç±»ï¼Œæ‰¿æ‹…äº†ä¿¡æ¯æ”¶é›†ã€æ–¹æ³•å†…æ±¡ç‚¹åˆ†æã€æ–¹æ³•é—´æ±¡ç‚¹ä¼ é€’ã€é€†æ‹“æ‰‘æ’åºã€JVM æŒ‡ä»¤æ¨¡æ‹Ÿã€sourceæ–¹æ³•æŸ¥æ‰¾ã€åˆ©ç”¨é“¾æ•´åˆç­‰ä»»åŠ¡ã€‚æˆ‘ä»¬æŒ‰ç…§æ‰«æé¡ºåºé‡ç‚¹åˆ†æä¸‹è¿™å‡ ä¸ªå…³é”®ç±»çš„ä»£ç </p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/6.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="2-1-MethodDiscovery-ç±»æ–¹æ³•ä¿¡æ¯æ”¶é›†"><a href="#2-1-MethodDiscovery-ç±»æ–¹æ³•ä¿¡æ¯æ”¶é›†" class="headerlink" title="2.1 MethodDiscovery ç±»æ–¹æ³•ä¿¡æ¯æ”¶é›†"></a>2.1 MethodDiscovery ç±»æ–¹æ³•ä¿¡æ¯æ”¶é›†</h3><p>MethodDiscoveryç±»ç”¨äºå‘ç°ç›®æ ‡classpathä¸­çš„çš„æ–¹æ³•ï¼Œä½†æ˜¯å®é™…æ‰«ææ—¶ä¼šæŠŠgadgetinspectoræœ¬èº«çš„ç±»ä¹Ÿæ”¶é›†è¿›å» å¹²æ‰°æˆ‘ä»¬çš„åˆ†æï¼Œæˆ‘åœ¨getAllClassesä¸­å¢åŠ äº†é€»è¾‘åˆ¤æ–­æ¥æ’é™¤gadgetinspectoræœ¬èº«çš„ç±»</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-id">#ClassResourceEnumerator</span><span class="hljs-selector-id">#getAllClasses</span><br><span class="hljs-selector-tag">for</span>(ClassPath.ClassInfo <span class="hljs-attribute">classInfo </span>: ClassPath.<span class="hljs-built_in">from</span>(classLoader).<span class="hljs-built_in">getAllClasses</span>())&#123;<br>            <span class="hljs-selector-tag">if</span>((!classInfo.<span class="hljs-built_in">getName</span>().<span class="hljs-built_in">contains</span>(<span class="hljs-string">&quot;gadgetinspector&quot;</span>)))&#123;<br>                <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.add</span>(new <span class="hljs-built_in">ClassLoaderClassResource</span>(classLoader,classInfo.<span class="hljs-built_in">getResourceName</span>()));<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/7.png" srcset="/img/loading.gif" lazyload></p>
<p>ç”¨äºè§‚å¯Ÿçš„ASMç±»ä¸ºMethodDiscovery.MethodDiscoveryClassVisitorï¼Œå…¶ç»§æ‰¿ClassVisitorç±»ï¼šé‡å†™äº†visitFieldã€visitMethodæ–¹æ³•ï¼Œåœ¨è§‚å¯Ÿåˆ°ç›®æ ‡ç±»çš„å±æ€§ã€æ–¹æ³•æ—¶ï¼Œå°†å…¶æ·»åŠ åˆ°å¾…åˆ†æçš„members Listä¸discoveredMethods Listä¸­</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/8.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/9.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="2-2-PassthroughDiscovery-å•æ–¹æ³•çš„æ±¡ç‚¹åˆ†æ"><a href="#2-2-PassthroughDiscovery-å•æ–¹æ³•çš„æ±¡ç‚¹åˆ†æ" class="headerlink" title="2.2 PassthroughDiscovery  å•æ–¹æ³•çš„æ±¡ç‚¹åˆ†æ"></a>2.2 PassthroughDiscovery  å•æ–¹æ³•çš„æ±¡ç‚¹åˆ†æ</h3><p>PassthroughDiscoveryç±»æ˜¯é’ˆå¯¹å•ä¸ªæ–¹æ³•çš„å±€éƒ¨æ±¡ç‚¹åˆ†æï¼Œå¾—åˆ°å¯å½±å“(æ±¡æŸ“)è¿”å›å€¼çš„å‚æ•°ç´¢å¼•ï¼Œç”Ÿæˆpassthroughæ•°æ®æµã€‚å…±æœ‰ä¸‰æ­¥ï¼š1ã€åˆ†æè°ƒç”¨å…³ç³»ï¼Œå¾—åˆ°æ¯ä¸ªæ–¹æ³•è°ƒç”¨çš„æ–¹æ³•é›†åˆï¼›2ã€å¯¹æ‰€æœ‰æ–¹æ³•çš„è°ƒç”¨è¿›è¡Œé€†æ‹“æ‰‘æ’åºï¼›3ã€åˆ†ææ•°æ®æµä¼ é€’æƒ…å†µï¼Œç”ŸæˆpassthroughDataflowæ•°æ®æµ</p>
<p>PassthroughDiscovery#discover</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/10.png" srcset="/img/loading.gif" lazyload></p>
<p>å¦‚ä¸‹æ˜¯åˆ†æFnEvalç±»çš„ç»“æœï¼Œorg.example.FnEval#invokeCallæ–¹æ³•å†…éƒ¨è°ƒç”¨äº†java.lang.Runtime#getRuntimeã€java.lang.Runtime#exec(java.lang.String)ä¸¤ä¸ªæ–¹æ³•</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/11.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="2-2-1-åˆ†ææ¯ä¸ªæ–¹æ³•çš„è°ƒç”¨å…³ç³»"><a href="#2-2-1-åˆ†ææ¯ä¸ªæ–¹æ³•çš„è°ƒç”¨å…³ç³»" class="headerlink" title="2.2.1 åˆ†ææ¯ä¸ªæ–¹æ³•çš„è°ƒç”¨å…³ç³»"></a>2.2.1 åˆ†ææ¯ä¸ªæ–¹æ³•çš„è°ƒç”¨å…³ç³»</h4><p>ç¬¬ä¸€æ­¥æ˜¯åˆ†æ2.1å¾—åˆ°çš„æ–¹æ³•é›†åˆï¼Œå°†æ¯ä¸ªæ–¹æ³•å†…éƒ¨è°ƒç”¨çš„æ–¹æ³•éƒ½å­˜å‚¨åˆ°methodCalls Mapä¸­ã€‚åˆ†æçš„æ ¸å¿ƒç±»æ˜¯MethodCallDiscoveryClassVisitorä¸MethodCallDiscoveryMethodVisitor</p>
<p>PassthroughDiscovery.MethodCallDiscoveryClassVisitor  ç»§æ‰¿è‡ªClassVisitorç±»ï¼šé‡å†™äº†visitMethodæ–¹æ³•ï¼Œæ–¹æ³•ä½“å†…ä½¿ç”¨MethodCallDiscoveryMethodVisitorè¿›è¡Œæ–¹æ³•çº§åˆ«çš„è§‚å¯Ÿåˆ†æ</p>
<p>PassthroughDiscovery.MethodCallDiscoveryMethodVisitor ç»§æ‰¿è‡ªMethodVisitorç±»ï¼šé‡å†™äº†visitMethodInsnæ–¹æ³•ï¼Œæ–¹æ³•ä½“å†…æ¯æ¬¡æ–¹æ³•è°ƒç”¨éƒ½ä¼šè§¦å‘è¯¥é‡å†™æ–¹æ³•ï¼Œç„¶åä¼šå°†è¢«è°ƒç”¨çš„æ–¹æ³•ä¿¡æ¯ï¼ˆæ‰€å±ç±»ä¿¡æ¯ã€æ–¹æ³•æè¿°ä¿¡æ¯ï¼‰æ·»åŠ åˆ°ç»“æœmethodCalls Mapä¸­</p>
<p>PassthroughDiscovery.MethodCallDiscoveryMethodVisitor#visitMethodInsn</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/12.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="2-2-2-é€†æ‹“æ‰‘æ’åº"><a href="#2-2-2-é€†æ‹“æ‰‘æ’åº" class="headerlink" title="2.2.2 é€†æ‹“æ‰‘æ’åº"></a>2.2.2 é€†æ‹“æ‰‘æ’åº</h4><p>å°†2.2.1å¾—åˆ°çš„methodCalls Mapç»è¿‡é€†æ‹“æ‰‘æ’åºå¾—åˆ°sortedMethods Listï¼ŒPassthroughDiscovery#topologicallySortMethodCalls æ’åºæ–¹æ³•å¦‚ä¸‹</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/13.png" srcset="/img/loading.gif" lazyload></p>
<p>æ’åºåˆ†æå‚è€ƒäº†Longofoå¸ˆå‚…çš„ <a target="_blank" rel="noopener" href="https://paper.seebug.org/1034/#step3-passthrough">åˆ†æ</a>  PassthroughDiscovery#dfsTsort</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/14.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>dfsStackï¼šç”¨æ¥åˆ†ææ–¹æ³•è°ƒç”¨é¡ºåºï¼Œä¿è¯åœ¨é€†æ‹“æ‰‘æ—¶å€™ä¸å½¢æˆç¯</li>
<li>visitedNodesï¼šè®¿é—®è¿‡çš„ç»“ç‚¹ï¼Œåœ¨ä¸€æ¡è°ƒç”¨é“¾å‡ºç°é‡åˆçš„æ—¶å€™ï¼Œä¸ä¼šé€ æˆé‡å¤çš„æ’åº</li>
<li>sortedMethodsï¼šæœ€ç»ˆé€†æ‹“æ‰‘æ’åºå‡ºæ¥çš„ç»“æœ</li>
</ul>
<p>ä¸¾ä¾‹å¦‚ä¸‹å›¾ä¸ºæ–¹æ³•è°ƒç”¨æ ‘ï¼Œåˆå§‹æ–¹æ³•ä¸ºmed1ï¼Œæœ‰6æ¡æ–¹æ³•è°ƒç”¨é“¾</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/15.png" srcset="/img/loading.gif" lazyload></p>
<p>æœ€ç»ˆç»è¿‡é€†æ‹“æ‰‘æ’åºåå¾—åˆ°çš„é¡ºåºæ˜¯ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">med7ã€med8ã€med3ã€med6ã€med2ã€med4ã€med1<br></code></pre></td></tr></table></figure>

<p>çœ‹åˆ°åœ¨gadgetinspector.PassthroughDiscovery#dfsTsortçš„å¼€å¤´æœ‰è¿™æ ·ä¸¤è¡Œä»£ç </p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/16.png" srcset="/img/loading.gif" lazyload></p>
<p>ç¬¬ä¸€ä¸ªifè¯­å¥ï¼ˆåœˆ1ï¼‰ç›®çš„æ˜¯å¤„ç†â€æ–¹æ³•äº’ç›¸è°ƒç”¨å½¢æˆç¯â€çš„é—®é¢˜ï¼Œå¦‚æœæ­£åœ¨åˆ†æçš„dfsStackä¸­åŒ…å«med1ï¼Œé‚£ä¹ˆå°±ä¸å¾€dfsStackä¸­å†æ·»åŠ äº†ã€‚ç¬¬äºŒä¸ªifè¯­å¥ï¼ˆåœˆ2ï¼‰æ˜¯å¤„ç†â€æ–¹æ³•é‡å¤è°ƒç”¨â€çš„é—®é¢˜ï¼Œå¦‚æœåœ¨åˆ†æmed1-&gt;med3è¿™æ¡é“¾æ—¶å‘ç°med3åœ¨med1-&gt;med2-med3é“¾ä¸­å·²è®¿é—®è¿‡ï¼Œé‚£ä¹ˆä¸å†ç»§ç»­è®¿é—®ã€‚ç­–ç•¥éå¸¸ç²—æš´ï¼Œå¯¹äºç¬¬ä¸€æ¬¡å·²æ’åºè¿‡çš„æ–¹æ³•ï¼Œç¬¬äºŒæ¬¡ç¢°åˆ°æ—¶ä¸å†åˆ†æã€‚è™½ç„¶é¿å…äº†é‡å¤æ‰«æè·Ÿç¯çš„é—®é¢˜ï¼Œä½†æ˜¯é€ æˆäº†ä¸¥é‡çš„æ¼æŠ¥ã€‚å¦‚æœmed1-&gt;med3-&gt;med7 åˆšå¥½å¯ä»¥èµ°é€šsourceåˆ°sinkï¼Œåˆ©ç”¨é“¾ä¹ŸçŸ­ï¼Œå·¥å…·ç”±äºç­–ç•¥é—®é¢˜åè€Œä¸ä¼šæ‰«åˆ°ã€‚æ‰€ä»¥è¿™ä¸€æ­¥éœ€è¦æ”¹è¿›ç­–ç•¥ä»¥å¹³è¡¡â€æœç´¢å¹¿åº¦ä¸æ·±åº¦ç­–ç•¥çš„å¹³è¡¡é—®é¢˜â€</p>
<p>å¦å¤–è¿™é‡Œä¸ºä»€ä¹ˆè¦ç”¨é€†æ‹“æ‰‘æ’åºDFSç®—æ³•ï¼Œè€Œä¸æ˜¯æ­£å‘æ‹“æ‰‘æ’åºBFSå‘¢ï¼Ÿè¿™ä¸ªæˆ‘ä»¬ä¸‹ä¸€ç« èŠ‚ä¼šç¢°åˆ°ï¼Œæ˜¯å› ä¸ºè¦ç¡®å®šçš„æ˜¯çˆ¶æ–¹æ³•çš„è¿”å›å€¼ä¸å“ªä¸ªå‚æ•°æœ‰å…³ï¼Œè€Œåœ¨æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œè¿”å›å€¼ä¼šå—åˆ°å­æ–¹æ³•çš„å½±å“ï¼Œæ‰€ä»¥éœ€è¦å…ˆåˆ¤æ–­å­æ–¹æ³•çš„å‚æ•°ä¸è¿”å›å€¼çš„å…³è”å…³ç³»ï¼Œè¿›è€Œæ‰èƒ½å¾—å‡ºçˆ¶æ–¹æ³•çš„å‚æ•°æ±¡æŸ“æƒ…å†µã€‚æ‰€ä»¥è¿™é‡Œéœ€è¦ä½¿ç”¨é€†æ‹“æ‰‘æ’åºDFSç®—æ³•</p>
<h4 id="2-2-3-å•ä¸ªæ–¹æ³•æ±¡ç‚¹åˆ†æ"><a href="#2-2-3-å•ä¸ªæ–¹æ³•æ±¡ç‚¹åˆ†æ" class="headerlink" title="2.2.3 å•ä¸ªæ–¹æ³•æ±¡ç‚¹åˆ†æ"></a>2.2.3 å•ä¸ªæ–¹æ³•æ±¡ç‚¹åˆ†æ</h4><p>ä¾æ¬¡åˆ†æ2.2.2æ­¥å¾—åˆ°çš„sortedMethods Liståï¼Œå¯ä»¥å¾—å‡ºæ¯ä¸ªæ–¹æ³•çš„è¿”å›å€¼å—å“ªä¸ªå‚æ•°çš„å½±å“(ä¹Ÿå«æ±¡æŸ“)ã€‚è¿™ä¸€æ­¥æ˜¯ä¿¡æ¯æœé›†çš„é‡ç‚¹ï¼Œæœ‰äº†æ¯ä¸ªæ–¹æ³•çš„æ±¡æŸ“ç»“æœåå°±å¯ä»¥å¼€å§‹ä¸²è”æ–¹æ³•è¿›è¡Œåˆ†æ</p>
<p>PassthroughDiscovery.PassthroughDataflowClassVisitor  ç»§æ‰¿è‡ªClassVisitorç±»ï¼Œé‡äº†å†™visitMethodæ–¹æ³•ï¼šå¯¹ç›®æ ‡æ–¹æ³•ä½¿ç”¨PassthroughDataflowMethodVisitorè¿›è¡Œæ–¹æ³•çº§åˆ«çš„è§‚å¯Ÿåˆ†æ</p>
<p>PassthroughDiscovery.PassthroughDataflowMethodVisitorç»§æ‰¿è‡ªTaintTrackingMethodVisitorç±»ï¼›çˆ¶ç±»TaintTrackingMethodVisitor ç»§æ‰¿è‡ªMethodVisitorç±»</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/17.png" srcset="/img/loading.gif" lazyload></p>
<p>TaintTrackingMethodVisitor#TaintTrackingMethodVisitor</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/18.png" srcset="/img/loading.gif" lazyload></p>
<p>è¿™ä¸¤è€…æ˜¯çˆ¶å­ç±»å…³ç³»ï¼Œå­ç±»PassthroughDataflowMethodVisitorå®ç°äº†ï¼švisitCodeã€visitInsnã€visitFieldInsnã€visitMethodInsnç­‰æ–¹æ³•</p>
<p>çˆ¶ç±»å®ç°äº†ï¼švisitCodeã€visitFrameã€visitInsnã€visitIntInsnã€visitVarInsnã€visitTypeInsnã€visitFieldInsnã€visitMethodInsnã€visitInvokeDynamicInsnã€visitJumpInsnã€visitLabelã€visitLdcInsnã€visitIincInsnã€visitTableSwitchInsnã€visitLookupSwitchInsnã€visitMultiANewArrayInsnã€visitInsnAnnotationã€visitTryCatchBlockã€visitTryCatchAnnotationã€visitMaxsã€visitEndç­‰æ–¹æ³•ã€‚è¿™äº›æ˜¯ASMè§‚å¯Ÿç±»ç¢°åˆ°å„ç§JVMæŒ‡ä»¤æ—¶ä¼šè§¦å‘è°ƒç”¨çš„æ–¹æ³•</p>
<p>è¿™å¯¹çˆ¶å­ç±»æ˜¯åˆ†ææ•°æ®æµçš„æ ¸å¿ƒç±»ï¼Œå…¶ä½¿ç”¨JAVA ASMæŠ€æœ¯è§‚å¯Ÿæ–¹æ³•&#x2F;å±æ€§&#x2F;å˜é‡æ“ä½œ&#x2F;å­æ–¹æ³•è°ƒç”¨ã€æ¨¡æ‹ŸJVM Stackå…¥æ ˆå‡ºæ ˆæ“ä½œï¼Œç›¸å½“äºè®©é™æ€ä»£ç â€åŠ¨â€äº†èµ·æ¥ï¼Œåœ¨åŠ¨çš„è¿‡ç¨‹ä¸­å»è§‚å¯Ÿå‚æ•°çš„ä¼ é€’æ±¡æŸ“ã€æ–¹æ³•çš„è°ƒç”¨ï¼Œè¿›è€Œæ‰¾å‡ºå¯ä»¥ä»sourceé€šå¾€sinkä¹‹é—´çš„é“¾è·¯ã€‚gadgetinspectorå¼€å‘è€…åœ¨TaintTrackingMethodVisitor.SavedVariableStateç±»ä¸­åˆ›å»ºäº†localVarsã€stackVarsç”¨æ¥å¯¹æ ‡æœ¬åœ°å˜é‡è¡¨Local Variable TableåŠæ“ä½œæ•°æ ˆ Operand Stackï¼Œåœ¨åŒç±»ä¸‹åˆ©ç”¨ASMæŠ€æœ¯ä¸­visitXXXç­‰è§‚å¯Ÿæ–¹æ³•æ¨¡æ‹Ÿäº†JVMæŒ‡ä»¤é›†è°ƒç”¨push()ã€pop()å¯¹å˜é‡è¡¨åŠæ“ä½œæ ˆçš„è¿›å‡ºæ“ä½œ</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/19.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/20.png" srcset="/img/loading.gif" lazyload></p>
<p>æ¥ç€åˆ†æçˆ¶å­ç±»å®ç°çš„å‡ ä¸ªå…³é”®æ–¹æ³•ï¼š</p>
<p>1ã€visitCodeï¼šè§‚å¯Ÿæ–¹æ³•æ—¶ï¼Œé¦–å…ˆä¼šå…ˆè§¦å‘visitCodeï¼Œå­ç±»å°† [[å¯¹è±¡å®ä¾‹],arg1,arg2]æŒ‰ç…§å…ˆåé¡ºåºæ·»åŠ åˆ°æœ¬åœ°å˜é‡è¡¨localVarsä¸­ï¼Œç”¨äºåç»­å‡ºæ ˆå…¥æ ˆçš„æ•°æ®æ¥æºã€‚è€Œçˆ¶ç±»ä½œç”¨æ˜¯åˆå§‹åŒ–äº†æœ¬åœ°å˜é‡è¡¨localVarsã€æ“ä½œæ•°æ ˆstackVars</p>
<p>PassthroughDiscovery.PassthroughDataflowMethodVisitor#visitCode</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/21.png" srcset="/img/loading.gif" lazyload></p>
<p>TaintTrackingMethodVisitor#visitCode ç”¨äºæ¸…ç©ºæœ¬åœ°å˜é‡è¡¨ä¸æ“ä½œæ•°æ ˆåŠå ä½</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/22.png" srcset="/img/loading.gif" lazyload></p>
<p>2ã€visitInsnï¼šè§‚å¯Ÿæ–¹æ³•æ—¶ï¼Œç¢°åˆ°æ— æ“ä½œæ•°æŒ‡ä»¤æ—¶ä¼šè§¦å‘visitInsn ï¼Œå­ç±»PassthroughDataflowMethodVisitorä¸»è¦å¤„ç†ç¢°åˆ°returnæŒ‡ä»¤é›†æ—¶çš„å‚æ•°æ±¡æŸ“æƒ…å†µï¼Œçˆ¶ç±»ä½œç”¨æ˜¯æ¨¡æ‹Ÿæ— æ“ä½œæ•°æŒ‡ä»¤é›†å¯¹åº”çš„å‡ºæ ˆå…¥æ ˆæ“ä½œï¼Œå¦‚[type]CONST_[n]æ¨é€æ•°æ®åˆ°æ ˆé¡¶ã€[type]ASTOREæ•°ç»„å‡ºæ ˆåˆ°è¡¨ã€[type]ALOADæ•°ç»„å‡ºè¡¨å…¥æ ˆç­‰ç­‰</p>
<p>PassthroughDataflowMethodVisitor#visitInsnæ˜¯æ“ä½œä¸­çš„é‡ç‚¹ï¼Œä¼šå°†æ ˆé¡¶æ•°æ®æ·»åŠ åˆ°æ±¡ç‚¹ç»“æœé›†åˆreturnTaintï¼Œæ­¤æ—¶æ ˆé¡¶å…ƒç´ å¯èƒ½ä¸ºï¼š1ã€å¯¹è±¡å®ä¾‹&#x2F;å®ä¾‹å±æ€§ï¼›2ã€è¢«è°ƒç”¨æ–¹æ³•çš„è¿”å›å€¼ã€‚ASMåœ¨ç¢°åˆ°è¿™ä¸¤è€…æ—¶ä¼šè°ƒç”¨visitFieldInsnã€visitMethodInsnè¿›è¡Œè§‚å¯Ÿï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•å‡ä¼šå°†æ±¡ç‚¹å‚æ•°ç´¢å¼•æ·»åŠ è‡³æ ˆé¡¶</p>
<p>PassthroughDiscovery.PassthroughDataflowMethodVisitor#visitInsn</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/23.png" srcset="/img/loading.gif" lazyload></p>
<p>TaintTrackingMethodVisitor#visitInsn</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/24.png" srcset="/img/loading.gif" lazyload></p>
<p>3ã€visitFieldInsnï¼šè§‚å¯Ÿæ–¹æ³•æ—¶ï¼Œæ¯æ¬¡å¯¹å±æ€§å­—æ®µçš„æ“ä½œéƒ½ä¼šè§¦å‘visitFieldInsnï¼Œå­ç±»PassthroughDataflowMethodVisitorä¸»è¦å¤„ç†GETFIELDæŒ‡ä»¤ï¼šå¯¹æ–¹æ³•æ‰€å±ç±»ä½¿ç”¨å†³ç­–å™¨serializableDecideråˆ¤æ–­ã€å¯¹å±æ€§åˆ¤æ–­æ˜¯å¦è¢«transientä¿®é¥°ã€‚æ‰€å±ç±»é€šè¿‡å†³ç­–å™¨ä¸”å±æ€§ä¸è¢«transientä¿®é¥°å°±é€šè¿‡å†³ç­–ã€‚çˆ¶ç±»æ¨¡æ‹Ÿäº† è·å–é™æ€å±æ€§å€¼GETSTATICã€è®¾ç½®é™æ€å±æ€§å€¼PUTSTATICã€è·å–éé™æ€å±æ€§å€¼GETFIELDã€è®¾ç½®éé™æ€å±æ€§å€¼PUTFIELD4ä¸ªJVMæŒ‡ä»¤çš„å‡ºæ ˆå…¥æ ˆæ“ä½œ</p>
<p>PassthroughDiscovery.PassthroughDataflowMethodVisitor#visitFieldInsn</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/25.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/26.png" srcset="/img/loading.gif" lazyload></p>
<p>TaintTrackingMethodVisitor#visitFieldInsn</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/27.png" srcset="/img/loading.gif" lazyload></p>
<p>4ã€visitMethodInsnï¼šè§‚å¯Ÿæ–¹æ³•æ—¶ï¼Œæ–¹æ³•ä½“å†…æ¯æ¬¡è°ƒç”¨å…¶å®ƒæ–¹æ³•æ—¶éƒ½ä¼šè§¦å‘visitMethodInsnã€‚å­ç±»ä¸»è¦å¤„ç† initåˆå§‹åŒ–æ–¹æ³•æ±¡æŸ“æƒ…å†µã€è°ƒç”¨ç›®æ ‡æ–¹æ³•çš„æ±¡æŸ“æƒ…å†µã€‚çˆ¶ç±»ä¸»è¦å¤„ç†initåˆå§‹åŒ–æ–¹æ³•ã€ç™½åå•ã€è°ƒç”¨ç›®æ ‡æ–¹æ³•çš„æ±¡æŸ“æƒ…å†µã€Collection&#x2F;Mapå­ç±»çš„æ–¹æ³•å‚æ•°çš„æ±¡æŸ“æƒ…å†µã€‚è°ƒç”¨æ–¹æ³•åˆ†ä¸ºè°ƒç”¨é™æ€æ–¹æ³•ã€å®ä¾‹æ–¹æ³•ã€è¶…ç±»æ„é€ æ–¹æ³•ã€æ¥å£æ–¹æ³•ï¼Œè°ƒç”¨æ–¹æ³•æ‰€å±ç±»ä¸ºå¼•ç”¨ç±»å‹æ—¶ä¼šè°ƒç”¨INVOKEVIRTUALæŒ‡ä»¤ã€ä¸ºæ¥å£æ—¶è°ƒç”¨INVOKEINTERFACEæŒ‡ä»¤</p>
<p>visitMethodInsnå…ˆå°†å®ä¾‹ã€å…¥å‚æŒ¨ä¸ªæ·»åŠ åˆ°argTypesæ•°ç»„</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/28.png" srcset="/img/loading.gif" lazyload></p>
<p>å‡å®šè¢«è°ƒç”¨æ–¹æ³•æœ‰Objectã€String 2ä¸ªå…¥å‚ï¼Œé‚£ä¹ˆargTypesä¸ºthisã€Objectã€Stringã€‚æ¥ç€å°†è°ƒç”¨ç›®æ ‡æ–¹æ³•å‰æ”¾åˆ°æ ˆä¸­çš„å‚æ•°(å³argTypes)ï¼Œéƒ½å¤åˆ¶ä¸€ä»½åˆ°argTaintã€‚å¦‚æœè¢«è°ƒç”¨æ–¹æ³•æ˜¯initæ–¹æ³•ï¼Œé‚£ä¹ˆthiså®ä¾‹ï¼ˆç´¢å¼•ä¸º0ï¼‰æ˜¯å¯ä»¥è¿›è¡Œæ±¡æŸ“ä¼ é€’çš„</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/29.png" srcset="/img/loading.gif" lazyload></p>
<p>ç”±äºæ–¹æ³•è°ƒç”¨é¡ºåºç»è¿‡é€†æ‹“æ‰‘æ’åºï¼Œæ‰€ä»¥åœ¨åˆ†ææ—¶å…¶æ–¹æ³•ä½“å†…è°ƒç”¨çš„å­æ–¹æ³•ä¸€å®šå·²ç»è¢«åˆ†æè¿‡ã€‚è¿™ä¸€æ­¥ä¼šåˆ†æè°ƒç”¨æ–¹æ³•çš„è¿”å›å€¼æ˜¯å¦ä¼šæ”¶åˆ°è¢«è°ƒç”¨æ–¹æ³•å‚æ•°çš„å½±å“ï¼Œå¦‚æœå½±å“ï¼Œé‚£ä¹ˆæ·»åŠ åˆ°æ±¡ç‚¹é›†åˆreturnTaint</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/30.png" srcset="/img/loading.gif" lazyload></p>
<p>å­ç±»åˆ¤æ–­ä¹‹åï¼Œå…ˆå°†æ±¡ç‚¹å‚æ•°ç´¢å¼•æ”¾åˆ°resultTaintï¼Œç„¶åè°ƒç”¨çˆ¶ç±»ç»§ç»­å¤„ç†initæ–¹æ³•ã€ObjectInputStream#defaultReadObjectã€ç™½åå•æ–¹æ³•ã€Map&#x2F;Collectionå­ç±»æ–¹æ³•ã€è¢«è°ƒç”¨æ–¹æ³•çš„æ±¡æŸ“ä¼ é€’æƒ…å†µï¼Œæœ€åæŠŠè¢«è°ƒç”¨æ–¹æ³•çš„æ±¡æŸ“å‚æ•°ç´¢å¼•æ”¾å…¥æ“ä½œæ•°æ ˆå†æ¬¡å›åˆ°å­ç±»ã€‚ç”±äºresultTaintæ˜¯Setç±»å‹ï¼Œæ‰€ä»¥æ·»åŠ æ—¶ä¼šè‡ªåŠ¨å¯¹ç´¢å¼•è¿›è¡Œå»é‡</p>
<p>TaintTrackingMethodVisitor#visitMethodInsn</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/31.png" srcset="/img/loading.gif" lazyload></p>
<p>å¦å¤–åœ¨2.3 CallGraphDiscovery#ModelGeneratorMethodVisitor ä¸­ä¼šåˆ¤æ–­è°ƒç”¨æ–¹æ³•çš„ä¼ å…¥å‚æ•°æ˜¯å¦ä¼šå½±å“è¢«è°ƒç”¨æ–¹æ³•çš„ä¼ å…¥å‚æ•°ï¼Œæœ€ååœ¨GadgetChainDiscoveryä¸­åˆ¤æ–­ä¸¤è€…å‚æ•°ç´¢å¼•æ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœä¸€è‡´è¡¨æ˜æ­¤é“¾å¯ä»¥èµ°é€š</p>
<p>5ã€visitVarInsnï¼šè§‚å¯Ÿæ–¹æ³•æ—¶ï¼Œæ–¹æ³•ä½“å†…æ¯æ¬¡å¯¹å±€éƒ¨å˜é‡æ“ä½œæ—¶éƒ½ä¼šè§¦å‘visitVarInsnï¼Œæ­¤æ–¹æ³•åœ¨çˆ¶ç±»ä¸­å®šä¹‰ã€‚ åˆ©ç”¨pushã€popæ–¹æ³•å¯¹æœ¬åœ°å˜é‡è¡¨localVarsã€æ“ä½œæ•°æ ˆstackVarsæ“ä½œæ¨¡æ‹Ÿå‡ºæ ˆå…¥æ ˆ [type]STOREã€[type]LOADç­‰JVMæŒ‡ä»¤</p>
<p>TaintTrackingMethodVisitor#visitVarInsn</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/32.png" srcset="/img/loading.gif" lazyload></p>
<p>ç»è¿‡å¦‚ä¸Šåˆ†æï¼Œæœ€åå¾—åˆ°çš„åˆ†æç»“æœéƒ½ä¿å­˜åœ¨passthrough.datæ–‡ä»¶ä¸­ï¼Œæ ¼å¼ä¸ºï¼šç±» æ–¹æ³• æ–¹æ³•æè¿° æ±¡ç‚¹ç´¢å¼•</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/33.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="2-3-CallGraphDiscovery-æ–¹æ³•é—´çš„æ±¡ç‚¹ä¼ é€’"><a href="#2-3-CallGraphDiscovery-æ–¹æ³•é—´çš„æ±¡ç‚¹ä¼ é€’" class="headerlink" title="2.3 CallGraphDiscovery æ–¹æ³•é—´çš„æ±¡ç‚¹ä¼ é€’"></a>2.3 CallGraphDiscovery æ–¹æ³•é—´çš„æ±¡ç‚¹ä¼ é€’</h3><p>2.2ä¸­çš„PassthroughDiscoveryåˆ†æå¾—åˆ°çš„æ˜¯è°ƒç”¨æ–¹æ³•è¿”å›å€¼ä¸è¢«è°ƒç”¨æ–¹æ³•å‚æ•°ä¼ é€’çš„å…³ç³»ï¼Œå¦‚æœæƒ³è¦çŸ¥é“æ–¹æ³•é“¾èƒ½å¦ä»sourceæºèµ°é€šåˆ°sinkç‚¹ï¼Œè¿˜éœ€è¦åˆ†ææ¯ä¸ªè°ƒç”¨æ–¹æ³•å…¥å‚ä¸è¢«è°ƒç”¨æ–¹æ³•å…¥å‚çš„ä¼ é€’å…³ç³»ï¼ŒCallGraphDiscoveryç±»å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜</p>
<p>è¿™ä¸€æ­¥çš„æ ¸å¿ƒä½¿ç”¨äº†ModelGeneratorClassVisitorï¼Œå…¶å®ç°äº†visitMethodã€visitOuterClassã€visitInnerClassç­‰æ–¹æ³•ï¼Œåœ¨visitMethodæ–¹æ³•ä¸­ä½¿ç”¨ModelGeneratorMethodVisitorè¿›è¡Œæ–¹æ³•çº§åˆ«çš„è§‚å¯Ÿåˆ†æã€‚ModelGeneratorMethodVisitorç±»ä¸PassthroughDataflowMethodVisitorä¸€æ ·ï¼Œéƒ½æ˜¯ç»§æ‰¿è‡ªTaintTrackingMethodVisitorç±»ï¼Œçˆ¶ç±»æˆ‘ä»¬åœ¨ä¸Šä¸€æ­¥2.2ç« å·²ç»åˆ†æè¿‡ä¸å†èµ˜è¿°ã€‚å­ç±»ModelGeneratorMethodVisitorä¸»è¦æ–¹æ³•æœ‰ï¼švisitCodeã€visitMethodInsnã€visitFieldInsnï¼Œä¾æ¬¡åˆ†æä¸‹ï¼š</p>
<p>1ã€åˆ©ç”¨visitCode() å¾€æœ¬åœ°å˜é‡è¡¨æ·»åŠ è°ƒç”¨æ–¹æ³•å…¥å‚(å½“æ–¹æ³•å­˜åœ¨2ä¸ªå½¢å‚æ—¶ï¼Œéé™æ€æ–¹æ³•ï¼š[[0,arg0],[1,arg1],[2,arg2]]  é™æ€æ–¹æ³•ï¼š[[0,arg0],[1,arg1]])ï¼›</p>
<p>CallGraphDiscovery.ModelGeneratorMethodVisitor#visitCode</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/34.png" srcset="/img/loading.gif" lazyload></p>
<p>2ã€åˆ©ç”¨visitFieldInsn()å°†è·å–çš„fieldåç§°å˜ä¸ºarg[n].[name]æ”¾å…¥æ“ä½œæ•°æ ˆä¾›åé¢æ–¹æ³•è°ƒç”¨æ—¶ä½¿ç”¨ï¼Œè¿™ä¸€æ­¥ä¸»è¦ä½œç”¨æ˜¯å°†æ–¹æ³•ä½“å†…æ“ä½œçš„å±æ€§ä¸æ–¹æ³•å…¥å‚åšå…³è”ï¼Œç”¨äºåˆ¤æ–­è°ƒç”¨æ–¹æ³•å…¥å‚ä¸è¢«è°ƒç”¨æ–¹æ³•å…¥å‚çš„å…³ç³»ã€‚è€Œè¿™é‡Œä¹Ÿä½¿ç”¨äº†è·Ÿ2.2ç« ä¸€æ ·çš„åˆ¤æ–­é€»è¾‘ï¼šå› ä¸ºjavaé‡Œé¢è§„å®šTransientä¿®é¥°å±æ€§ä¸å‚ä¸ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œæ‰€ä»¥ä¸è€ƒè™‘Transientå±æ€§ä¿®é¥°çš„å˜é‡ä¼ é€’ã€‚ä½†æ˜¯åœ¨å®é™…æŒ–æ˜è¿‡ç¨‹ä¸­è¿˜å­˜åœ¨ä¸€ç§æƒ…å†µï¼šè™½ç„¶å±æ€§è¢«Transientä¿®é¥°ï¼Œä½†æ˜¯ç±»è‡ªå·±å®ç°äº†writeObject&#x2F;writeExternalæ–¹æ³•ï¼Œæ–¹æ³•ä½“å†…ä¼šå£°æ˜å°†Transientå±æ€§å‚ä¸åˆ°åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ã€‚è¿™ç§æƒ…å†µåœ¨ä¹‹å‰çš„gadgetä¸­ä¹Ÿæ¯”è¾ƒå¸¸è§ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦é¢å¤–è¡¥å……å®Œå–„ä¸‹Transientå±æ€§çš„åˆ¤æ–­é€»è¾‘</p>
<p>CallGraphDiscovery.ModelGeneratorMethodVisitor#visitFieldInsn</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/35.png" srcset="/img/loading.gif" lazyload></p>
<p>3ã€visitMethodInsn()æ–¹æ³•åˆ›å»ºäº†arg[N]è¿›è¡Œæ ‡è®°ï¼Œåˆ†æè°ƒç”¨æ–¹æ³•ä¸è¢«è°ƒç”¨æ–¹æ³•é—´çš„å‚æ•°ä¼ é€’å…³ç³»ï¼Œå¹¶æœ€ç»ˆå°†ç»“æœèµ‹å€¼discoveredCallså­˜å‚¨åˆ°callgraph.datä¸­ï¼Œæ ¼å¼ä¸º<code>è°ƒç”¨è€…ç±»å | è°ƒç”¨è€…æ–¹æ³• | è°ƒç”¨è€…æ–¹æ³•æè¿° | è¢«è°ƒç”¨è€…ç±»å | è¢«è°ƒç”¨è€…æ–¹æ³• | è¢«è°ƒç”¨è€…æ–¹æ³•æè¿° | è°ƒç”¨è€…æ–¹æ³•å‚index | è°ƒç”¨è€…å­—æ®µå | è¢«è°ƒç”¨è€…æ–¹æ³•å‚æ•°ç´¢å¼•</code></p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/36.png" srcset="/img/loading.gif" lazyload></p>
<p>4ã€ä¸¾ä¸ªä¾‹å­ï¼ŒcreateMBeanæ–¹æ³•ç»è¿‡ModelGeneratorClassVisitoræ‰«æåå¾—åˆ°å¦‚ä¸‹ç»“æœï¼Œè°ƒç”¨æ–¹æ³•createMBeanå‚æ•°ç´¢å¼•(ç¬¬2ä¸ªå½¢å‚name)ä¸è¢«è°ƒç”¨æ–¹æ³•cloneObjectName(ç¬¬1ä¸ªå½¢å‚name)çš„å‚æ•°ä¼ é€’ã€‚è°ƒç”¨è€…å­—æ®µåçš„å€¼ä¸ºç©ºï¼Œè¯´æ˜ä»è°ƒç”¨æ–¹æ³•å…¥å‚ä¼ é€’åˆ°è¢«è°ƒç”¨æ–¹æ³•å…¥å‚çš„æ˜¯å…¥å‚å®ä¾‹ï¼ˆarg1ï¼‰è€Œä¸æ˜¯å…¥å‚ç±»å®ä¾‹çš„å±æ€§(arg1.nameã€arg1.pwd)</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">è°ƒç”¨è€…ç±»å | è°ƒç”¨è€…æ–¹æ³• | è°ƒç”¨è€…æ–¹æ³•æè¿° | è¢«è°ƒç”¨è€…ç±»å | è¢«è°ƒç”¨è€…æ–¹æ³• | è¢«è°ƒç”¨è€…æ–¹æ³•æè¿° | è°ƒç”¨è€…æ–¹æ³•å‚index | è°ƒç”¨è€…å­—æ®µå | è¢«è°ƒç”¨è€…æ–¹æ³•å‚æ•°ç´¢å¼•<br>com<span class="hljs-regexp">/sun/</span>jmx<span class="hljs-regexp">/mbeanserver/</span>JmxMBeanServer	createMBean	(Ljava<span class="hljs-regexp">/lang/</span>String;Ljavax<span class="hljs-regexp">/management/</span>ObjectName;)Ljavax<span class="hljs-regexp">/management/</span>ObjectInstance;	com<span class="hljs-regexp">/sun/</span>jmx<span class="hljs-regexp">/mbeanserver/</span>JmxMBeanServer	cloneObjectName	(Ljavax<span class="hljs-regexp">/management/</span>ObjectName;)Ljavax<span class="hljs-regexp">/management/</span>ObjectName;	<span class="hljs-number">2</span>		<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p>com.sun.jmx.mbeanserver.JmxMBeanServer#createMBean(java.lang.String, javax.management.ObjectName)</p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs processing"><span class="hljs-keyword">public</span> ObjectInstance <span class="hljs-title function_">createMBean</span>(<span class="hljs-built_in">String</span> className, ObjectName name)<br>        <span class="hljs-keyword">throws</span> ReflectionException, InstanceAlreadyExistsException,<br>               MBeanRegistrationException, MBeanException,<br>               NotCompliantMBeanException &#123;<br><br>        <span class="hljs-keyword">return</span> mbsInterceptor.<span class="hljs-property">createMBean</span>(className,<br>                                          <span class="hljs-title function_">cloneObjectName</span>(name),<br>                                          (<span class="hljs-built_in">Object</span>[]) <span class="hljs-literal">null</span>,<br>                                          (<span class="hljs-built_in">String</span>[]) <span class="hljs-literal">null</span>);<br>    &#125;<br></code></pre></td></tr></table></figure>

<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/37.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="2-4-SourceDiscovery-Sourceæºå‘ç°"><a href="#2-4-SourceDiscovery-Sourceæºå‘ç°" class="headerlink" title="2.4 SourceDiscovery Sourceæºå‘ç°"></a>2.4 SourceDiscovery Sourceæºå‘ç°</h3><p>SourceDiscoveryæ˜¯æŠ½è±¡ç±»ï¼Œå…¶discover(classMapï¼ŒmethodMapï¼ŒinheritanceMap)æ–¹æ³•åªæä¾›äº†å®šä¹‰ï¼Œå…·ä½“çš„å®ç°éœ€è¦ä½¿ç”¨è€…è‡ªå·±æ‰©å±•ç¼–å†™ã€‚è€Œgadgetinspectorå†…ç½®äº†javaåŸç”Ÿååºåˆ—åŒ–ã€jacksonååºåˆ—åŒ– çš„SourceDiscoveryå®ç°ç±»</p>
<p>è¯¥æ­¥éª¤ä¸»è¦æŸ¥æ‰¾ååºåˆ—åŒ–å…¥å£æ–¹æ³•ï¼Œæ¯ç§ååºåˆ—åŒ–æ“ä½œçš„å…¥å£æ–¹æ³•ä¸åŒï¼Œå¦‚fastjson&#x2F;jacksonçš„å…¥å£æ˜¯getter&#x2F;setteræ–¹æ³•ã€javaåŸç”Ÿååºåˆ—åŒ–æ˜¯readObject&#x2F;readExternaæ–¹æ³•ã€‚è¿™é‡Œå…ˆä»¥å†…ç½®çš„jacksonä¸ºä¾‹åˆ†æï¼Œjacksonåœ¨å¯¹jsonå­—ç¬¦ä¸²ååºåˆ—åŒ–æ“ä½œæ—¶ï¼Œä¼šè°ƒç”¨ç±»çš„æ— å‚æ„é€ æ–¹æ³•è¿›è¡Œç±»å®ä¾‹åŒ–ï¼Œæ‰€ä»¥åªæœ‰å­˜åœ¨æ— å‚æ„é€ æ–¹æ³•çš„ç±»æ‰æ»¡è¶³jacksonåºåˆ—åŒ–ç±»çš„è¦æ±‚ï¼Œå¦å¤–åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¼šæ ¹æ®å…·ä½“æƒ…å†µè°ƒç”¨getter&#x2F;setteræ–¹æ³•ã€‚æ‰€ä»¥åœ¨æ‰«æjacksonååºåˆ—åŒ–gadgetæ—¶æŠŠè¿™ä¸‰ä¸ªæ–¹æ³•å‡æ·»åŠ åˆ°sourceé‡Œé¢è¿›è¡Œæ‰«æ</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/38.png" srcset="/img/loading.gif" lazyload></p>
<p>æœ€ç»ˆæŠŠæ‰«æçš„ç»“æœå­˜å‚¨åˆ°source.datæ–‡ä»¶ä¸­ï¼Œæ ¼å¼å¦‚ä¸‹</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">ç±»å æ–¹æ³•å æ–¹æ³•æè¿° æ±¡æŸ“å‚æ•°ç´¢å¼•<br>java<span class="hljs-regexp">/awt/</span>TextField	&lt;init&gt;	()V	<span class="hljs-number">0</span><br>javax<span class="hljs-regexp">/swing/</span>JTextField	setActionCommand	(Ljava<span class="hljs-regexp">/lang/</span>String;)V	<span class="hljs-number">0</span><br>javax<span class="hljs-regexp">/swing/</span>JEditorPane	setPage	(Ljava<span class="hljs-regexp">/lang/</span>String;)V	<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<h3 id="2-5-GadgetChainDiscovery-ä¿¡æ¯æ•´åˆä¸ºGadgetChain"><a href="#2-5-GadgetChainDiscovery-ä¿¡æ¯æ•´åˆä¸ºGadgetChain" class="headerlink" title="2.5 GadgetChainDiscovery ä¿¡æ¯æ•´åˆä¸ºGadgetChain"></a>2.5 GadgetChainDiscovery ä¿¡æ¯æ•´åˆä¸ºGadgetChain</h3><p>GadgetChainDiscovery#discover æ–¹æ³•å¯¹ä¸Šè¿°æœé›†åˆ°çš„æ‰€æœ‰ä¿¡æ¯è¿›è¡Œæ•´åˆï¼Œç„¶åå°†æ¯ä¸ªsourceä½œä¸ºåˆ©ç”¨é“¾çš„èµ·ç‚¹å¯»æ‰¾è°ƒç”¨çš„å­æ–¹æ³•ã€èƒ½å°†å‚æ•°æ±¡æŸ“ä¼ é€’çš„å­æ–¹æ³•ï¼Œå¦‚æœæœ«èŠ‚ç‚¹è°ƒç”¨åˆ°å…ˆå‰å®šä¹‰å¥½çš„sinkæ–¹æ³•ï¼Œè¯´æ˜åˆ©ç”¨é“¾å¯ä»¥èµ°é€šï¼Œé‚£ä¹ˆå°±æ ‡è®°æˆåŠŸï¼Œæ·»åŠ åˆ°discoveredGadgetsä¸­ã€‚å¦åˆ™å†æ¬¡å¾ªç¯methodsToExploreè·å–æ–¹æ³•è¿›è¡Œåˆ†æç›´åˆ°æ–¹æ³•å¾ªç¯å®Œæ¯•ã€‚ä¸»è¦çœ‹ä¸‹å¯¹äºé‡å†™æ–¹æ³•ã€æœç´¢ç­–ç•¥çš„å¤„ç†</p>
<p>1ã€InheritanceDeriver#getAllMethodImplementationsæœé›†é‡å†™æ–¹æ³•</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/39.png" srcset="/img/loading.gif" lazyload></p>
<p>å°†æœé›†åˆ°çš„é‡å†™æ–¹æ³•çš„ç»“æœä¿å­˜åˆ°methodimpl.datï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs">ç±» æ–¹æ³• æ–¹æ³•æè¿°<br>	å­ç±»1 é‡å†™æ–¹æ³• æ–¹æ³•æè¿°<br>	å­ç±»2 é‡å†™æ–¹æ³• æ–¹æ³•æè¿°<br></code></pre></td></tr></table></figure>

<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/40.png" srcset="/img/loading.gif" lazyload></p>
<p>2ã€å°†è°ƒç”¨çš„æ–¹æ³•é›†åˆè§„æ•´æ ¼å¼å¾—åˆ°graphCallMapï¼Œkeyä¸ºè°ƒç”¨æ–¹æ³•ã€valueä¸ºè¢«è°ƒç”¨æ–¹æ³•Set(æ·»åŠ æ—¶è‡ªåŠ¨æŠ›å¼ƒé‡å¤æ–¹æ³•)</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/41.png" srcset="/img/loading.gif" lazyload></p>
<p>å¦‚ä¸Šé¢æåˆ°çš„com.sun.jmx.mbeanserver.JmxMBeanServer#createMBeanæ–¹æ³•è°ƒç”¨äº†createMBeanã€cloneObjectNameä¸¤ä¸ªæ–¹æ³•ï¼Œè¿™ä¸€æ­¥å°±æ˜¯å°†ä¸¤ä¸ªå­æ–¹æ³•æ•´åˆï¼Œæœ€ç»ˆå¾—åˆ°[JmxMBeanServer#createMBeanï¼š[createMBeanï¼ŒcloneObjectName]]è¿™ç§ç»“æ„</p>
<p><img src="/../../../2%E8%87%AA%E5%8A%A8%E5%8C%96%E5%AE%A1%E8%AE%A1/gadgetinspector/1%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86/img/1676531278617.png" srcset="/img/loading.gif" lazyload alt="1676531278617"></p>
<p>3ã€åŠ è½½2.4ç« ä¸­å¾—åˆ°çš„sources.datï¼Œå°†æ¯ä¸ªsourceåšä¸ºGadgetChainé“¾çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚ç¨‹åºå¾ªç¯å°†åˆ©ç”¨é“¾GadgetChainçš„æœ«èŠ‚ç‚¹åšä¸ºèµ·ç‚¹æ–¹æ³•æŸ¥æ‰¾å¯è°ƒç”¨çš„å­æ–¹æ³•ã€å¯ä¼ é€’æ±¡æŸ“çš„å‚æ•°ç´¢å¼•ï¼Œå¦‚æœå¯ä»¥ä¼ é€’æ±¡æŸ“ï¼Œé‚£ä¹ˆå°±å°†è¢«è°ƒç”¨æ–¹æ³•åŠ åˆ°åˆ©ç”¨é“¾ã€‚æœ€ååˆ¤æ–­å¦‚æœæœ«èŠ‚ç‚¹è°ƒç”¨åˆ°æˆ‘ä»¬å…ˆå‰å®šä¹‰å¥½çš„sinkæ–¹æ³•ï¼Œè¯´æ˜åˆ©ç”¨é“¾å¯ä»¥èµ°é€šï¼Œé‚£ä¹ˆå°±æ ‡è®°æˆåŠŸï¼Œæ·»åŠ åˆ°discoveredGadgetsä¸­ã€‚å¦åˆ™å†æ¬¡å¾ªç¯methodsToExploreè¿›è¡ŒæŸ¥æ‰¾ç›´åˆ°æ–¹æ³•å¾ªç¯å®Œæ¯•</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/42.png" srcset="/img/loading.gif" lazyload></p>
<p>å¦‚ä¸‹å›¾çš„åœˆ1åˆ¤æ–­å½“â€å¯ä¼ é€’æ±¡æŸ“ç»™å­æ–¹æ³•çš„è°ƒç”¨æ–¹æ³•å‚æ•°ç´¢å¼•â€ä¸â€è°ƒç”¨æ–¹æ³•å¯ä»¥æ§åˆ¶çš„å‚æ•°ç´¢å¼•â€ä¸ä¸€è‡´æ—¶ï¼Œæ±¡æŸ“å°±æ— æ³•ä¼ é€’ï¼Œpassã€‚åœˆ2ç”¨äºå¤„ç†â€é™æ€åˆ†ææ— æ³•ç¡®è®¤ç¨‹åºè¿è¡Œæ—¶ä½¿ç”¨å“ªä¸ªå®ç°æ–¹æ³•â€çš„é—®é¢˜ï¼Œæ‰€ä»¥å°†æ‰€æœ‰å®ç°æ–¹æ³•éƒ½è·‘ä¸€éã€‚åœˆ3åˆ¤æ–­å¦‚æœæ–°èŠ‚ç‚¹åœ¨ä¹‹å‰è®¿é—®è¿‡ï¼Œåˆ™è·³è¿‡æ£€æŸ¥ã€‚è¿™é‡Œè™½ç„¶å¯ä»¥é¿å…ç¯çš„é—®é¢˜ï¼Œä½†æ˜¯ä¼šé€ æˆæ¼æŠ¥ï¼Œéœ€è¦ä¿®æ”¹ä¸‹é€»è¾‘ã€‚åœˆ4åˆ¤æ–­æœ«èŠ‚ç‚¹çš„æ–¹æ³•ã€æ±¡æŸ“çš„å‚æ•°æ˜¯å¦ä¸å®šä¹‰å¥½çš„sinkä¸€è‡´ï¼Œå¦‚æœä¸€è‡´åˆ™æ·»åŠ åˆ°åˆ©ç”¨é“¾discoveredGadgets</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/43.png" srcset="/img/loading.gif" lazyload></p>
<p>ç»è¿‡MethodDiscoveryè·å–ç±»&#x2F;æ–¹æ³•&#x2F;ç»§æ‰¿å…³ç³»ä¿¡æ¯ã€PassthroughDiscoveryè·å–å•ä¸ªæ–¹æ³•å†…çš„æ±¡æŸ“ä¼ é€’ã€CallGraphDiscoveryè·å–æ–¹æ³•é—´çš„æ±¡æŸ“ä¼ é€’ã€SourceDiscoveryè·å–åˆ©ç”¨é“¾çš„sourceæºï¼Œæœ€ç»ˆé€šè¿‡GadgetChainDiscovery åˆ†æå‰é¢å¾—åˆ°çš„ä¿¡æ¯å¹¶æ•´åˆä¸ºGadgetChainç»“æœå­˜å‚¨åˆ°gadget-chains.txtæ–‡ä»¶ä¸­</p>
<h2 id="3ã€å®é™…æµ‹è¯•"><a href="#3ã€å®é™…æµ‹è¯•" class="headerlink" title="3ã€å®é™…æµ‹è¯•"></a>3ã€å®é™…æµ‹è¯•</h2><p>äº†è§£äº†å¦‚ä¸Šé¡¹ç›®æºç ã€å·¥å…·è¿è¡Œæµç¨‹ä¹‹åï¼Œæˆ‘ä»¬å®é™…ä½¿ç”¨GadgetInspectoræ‰«ææµ‹è¯•ä¸€ä¸ªDemo jaråŒ…æ„Ÿå—ä¸‹</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">Demoä»£ç <br>GadgetInspector-Test-Demo\out\artifacts\GadgetInspector_Test_Demo<br><br>ç¼–è¯‘gadget-<span class="hljs-keyword">inspector</span><br><span class="hljs-keyword"></span>GadGetResearch\gadgetinspector-master&gt;gradlew.<span class="hljs-keyword">bat </span><span class="hljs-keyword">shadowJar </span>--warning-mode all<br><br>æ‰«æå‘½ä»¤<br><span class="hljs-keyword">java </span>-Xmx10g -<span class="hljs-keyword">jar </span>gadget-<span class="hljs-keyword">inspector-all.jar </span>--<span class="hljs-built_in">config</span> <span class="hljs-keyword">jserial </span>E:\imgs-source\GadgetInspector-Test-Demo\out\artifacts\GadgetInspector_Test_Demo\GadgetInspector-Test-Demo.<span class="hljs-keyword">jar</span><br><span class="hljs-keyword"></span><br>é¡¹ç›®æ–‡ä»¶ç”Ÿæˆä½ç½®<br>GadGetResearch\gadgetinspector-master\<span class="hljs-keyword">build\libs</span><br></code></pre></td></tr></table></figure>

<p>1ã€æšä¸¾æ‰€æœ‰ç±»åŠç±»çš„æ‰€æœ‰æ–¹æ³•ï¼Œè¾“å‡ºç±»ä¿¡æ¯æ–‡ä»¶classes.dat</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gradle">org<span class="hljs-regexp">/example/</span>FnCompose	java<span class="hljs-regexp">/lang/</span>Object	org<span class="hljs-regexp">/example/I</span>Fn,java<span class="hljs-regexp">/io/</span>Serializable	<span class="hljs-keyword">false</span>	f1!<span class="hljs-number">2</span>!org<span class="hljs-regexp">/example/I</span>Fn!f2!<span class="hljs-number">2</span>!org<span class="hljs-regexp">/example/I</span>Fn<br>org<span class="hljs-regexp">/example/</span>FnConstant	java<span class="hljs-regexp">/lang/</span>Object	org<span class="hljs-regexp">/example/I</span>Fn,java<span class="hljs-regexp">/io/</span>Serializable	<span class="hljs-keyword">false</span>	value!<span class="hljs-number">2</span>!java<span class="hljs-regexp">/lang/</span>Object<br>org<span class="hljs-regexp">/example/</span>FnEval	java<span class="hljs-regexp">/lang/</span>Object	org<span class="hljs-regexp">/example/I</span>Fn,java<span class="hljs-regexp">/io/</span>Serializable	<span class="hljs-keyword">false</span>	<br>org<span class="hljs-regexp">/example/I</span>Fn	java<span class="hljs-regexp">/lang/</span>Object		<span class="hljs-keyword">true</span>	<br>org<span class="hljs-regexp">/example/m</span>odel<span class="hljs-regexp">/AbstractTableModel	java/</span>lang<span class="hljs-regexp">/Object	java/i</span>o<span class="hljs-regexp">/Serializable	false	__clojureFnMap!2!java/u</span>til/HashMap<br>org<span class="hljs-regexp">/example/</span>TestDemo	java<span class="hljs-regexp">/lang/</span>Object		<span class="hljs-keyword">false</span>	test!<span class="hljs-number">2</span>!java<span class="hljs-regexp">/lang/</span>String<br></code></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>ç±»å</th>
<th>çˆ¶ç±»å</th>
<th>å®ç°çš„æ‰€æœ‰æ¥å£</th>
<th>æ˜¯å¦æ¥å£</th>
<th>æˆå‘˜å˜é‡(ä»¥!åˆ†å‰²)</th>
</tr>
</thead>
<tbody><tr>
<td>org&#x2F;example&#x2F;FnCompose</td>
<td>java&#x2F;lang&#x2F;Object</td>
<td>org&#x2F;example&#x2F;IFn,java&#x2F;io&#x2F;Serializable</td>
<td>false</td>
<td>f1!2!org&#x2F;example&#x2F;IFn!f2!2!org&#x2F;example&#x2F;IFn</td>
</tr>
</tbody></table>
<p>æˆå‘˜å˜é‡f1!2!org&#x2F;example&#x2F;IFn!è¡¨ç¤ºï¼šå­—æ®µåç§°ä¸ºf1ã€modifiersä¸º2(privateä¿®é¥°)ã€å˜é‡ç±»å‹ä¸ºorg&#x2F;example&#x2F;IFnç±»</p>
<p>åœ¨gadgetinspectorä¸­çš„å®šä¹‰ç±»ä¸ºgadgetinspector.data.ClassReferenceã€gadgetinspector.data.ClassReference.Member</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/44.png" srcset="/img/loading.gif" lazyload></p>
<p>è¾“å‡ºæ–¹æ³•ä¿¡æ¯æ–‡ä»¶methods.dat</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs gradle">org<span class="hljs-regexp">/example/</span>FnCompose	&lt;init&gt;	(Lorg<span class="hljs-regexp">/example/I</span>Fn;Lorg<span class="hljs-regexp">/example/I</span>Fn;)V	<span class="hljs-keyword">false</span><br>org<span class="hljs-regexp">/example/</span>FnCompose	invokeCall	(Ljava<span class="hljs-regexp">/lang/</span>Object;)Ljava<span class="hljs-regexp">/lang/</span>Object;	<span class="hljs-keyword">false</span><br>org<span class="hljs-regexp">/example/</span>FnConstant	&lt;init&gt;	(Ljava<span class="hljs-regexp">/lang/</span>Object;)V	<span class="hljs-keyword">false</span><br>org<span class="hljs-regexp">/example/</span>FnConstant	invokeCall	(Ljava<span class="hljs-regexp">/lang/</span>Object;)Ljava<span class="hljs-regexp">/lang/</span>Object;	<span class="hljs-keyword">false</span><br>org<span class="hljs-regexp">/example/</span>FnEval	&lt;init&gt;	()V	<span class="hljs-keyword">false</span><br>org<span class="hljs-regexp">/example/</span>FnEval	invokeCall	(Ljava<span class="hljs-regexp">/lang/</span>Object;)Ljava<span class="hljs-regexp">/lang/</span>Object;	<span class="hljs-keyword">false</span><br>org<span class="hljs-regexp">/example/I</span>Fn	invokeCall	(Ljava<span class="hljs-regexp">/lang/</span>Object;)Ljava<span class="hljs-regexp">/lang/</span>Object;	<span class="hljs-keyword">false</span><br>org<span class="hljs-regexp">/example/m</span>odel<span class="hljs-regexp">/AbstractTableModel	&lt;init&gt;	(Ljava/u</span>til/HashMap;)V	<span class="hljs-keyword">false</span><br>org<span class="hljs-regexp">/example/m</span>odel/AbstractTableModel	hashCode	()I	<span class="hljs-keyword">false</span><br>org<span class="hljs-regexp">/example/</span>TestDemo	&lt;init&gt;	()V	<span class="hljs-keyword">false</span><br>org<span class="hljs-regexp">/example/</span>TestDemo	pMethod	(Ljava<span class="hljs-regexp">/lang/</span>String;)Ljava<span class="hljs-regexp">/lang/</span>String;	<span class="hljs-keyword">false</span><br>org<span class="hljs-regexp">/example/</span>TestDemo	cMethod	(Ljava<span class="hljs-regexp">/lang/</span>String;)Ljava<span class="hljs-regexp">/lang/</span>String;	<span class="hljs-keyword">false</span><br></code></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>æ–¹æ³•æ‰€åœ¨ç±»</th>
<th>æ–¹æ³•å</th>
<th>æ–¹æ³•å‚æ•°åŠè¿”å›å€¼</th>
<th>æ˜¯å¦é™æ€æ–¹æ³•</th>
</tr>
</thead>
<tbody><tr>
<td>org&#x2F;example&#x2F;FnCompose</td>
<td>invokeCall</td>
<td>(Ljava&#x2F;lang&#x2F;Object;)Ljava&#x2F;lang&#x2F;Object;</td>
<td>false</td>
</tr>
</tbody></table>
<p>åœ¨gadgetinspectorä¸­çš„å®šä¹‰ç±»ä¸ºgadgetinspector.data.MethodReference</p>
<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/45.png" srcset="/img/loading.gif" lazyload></p>
<p>inheritanceMap.dat  ç±»çš„ç»§æ‰¿å…³ç³»</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">org<span class="hljs-regexp">/example/m</span>odel<span class="hljs-regexp">/AbstractTableModel	java/</span>lang<span class="hljs-regexp">/Object	java/i</span>o/Serializable<br>org<span class="hljs-regexp">/example/</span>FnCompose	java<span class="hljs-regexp">/lang/</span>Object	java<span class="hljs-regexp">/io/</span>Serializable	org<span class="hljs-regexp">/example/</span>IFn<br>org<span class="hljs-regexp">/example/</span>FnEval	java<span class="hljs-regexp">/lang/</span>Object	java<span class="hljs-regexp">/io/</span>Serializable	org<span class="hljs-regexp">/example/</span>IFn<br>org<span class="hljs-regexp">/example/</span>TestDemo	java<span class="hljs-regexp">/lang/</span>Object<br>org<span class="hljs-regexp">/example/</span>FnConstant	java<span class="hljs-regexp">/lang/</span>Object	java<span class="hljs-regexp">/io/</span>Serializable	org<span class="hljs-regexp">/example/</span>IFn<br>org<span class="hljs-regexp">/example/</span>IFn	java<span class="hljs-regexp">/lang/</span>Object<br></code></pre></td></tr></table></figure>

<p>2ã€ç”Ÿæˆpassthroughæ•°æ®æµï¼Œè¾“å‡ºä¿¡æ¯æ–‡ä»¶passthrough.dat</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">org<span class="hljs-regexp">/example/</span>TestDemo	cMethod	(Ljava<span class="hljs-regexp">/lang/</span>String;)Ljava<span class="hljs-regexp">/lang/</span>String;	<span class="hljs-number">1</span>,<br>org<span class="hljs-regexp">/example/</span>TestDemo	pMethod	(Ljava<span class="hljs-regexp">/lang/</span>String;)Ljava<span class="hljs-regexp">/lang/</span>String;	<span class="hljs-number">1</span>,<br>org<span class="hljs-regexp">/example/</span>FnConstant	invokeCall	(Ljava<span class="hljs-regexp">/lang/</span>Object;)Ljava<span class="hljs-regexp">/lang/</span>Object;	<span class="hljs-number">0</span>,   <span class="hljs-number">0</span>æ˜¯å®ä¾‹<br></code></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>ç±»å</th>
<th>æ–¹æ³•å</th>
<th>æ–¹æ³•æè¿°</th>
<th>èƒ½æ±¡æŸ“çš„å‚æ•°1ç´¢å¼•,èƒ½æ±¡æŸ“çš„å‚æ•°2ç´¢å¼•</th>
</tr>
</thead>
<tbody><tr>
<td>org&#x2F;example&#x2F;TestDemo</td>
<td>cMethod</td>
<td>(Ljava&#x2F;lang&#x2F;String;)Ljava&#x2F;lang&#x2F;String;</td>
<td>1,</td>
</tr>
</tbody></table>
<p>3ã€ç”Ÿæˆpassthroughè°ƒç”¨å›¾ï¼Œè¾“å‡ºä¿¡æ¯æ–‡ä»¶callgraph.dat</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs gradle">org<span class="hljs-regexp">/example/m</span>odel<span class="hljs-regexp">/AbstractTableModel	hashCode	()I	org/</span>example<span class="hljs-regexp">/IFn	invokeCall	(Ljava/</span>lang<span class="hljs-regexp">/Object;)Ljava/</span>lang/Object;	<span class="hljs-number">0</span>	__clojureFnMap	<span class="hljs-number">0</span><br>org<span class="hljs-regexp">/example/m</span>odel<span class="hljs-regexp">/AbstractTableModel	hashCode	()I	java/u</span>til/HashMap	hashCode	()I	<span class="hljs-number">0</span>	__clojureFnMap	<span class="hljs-number">0</span><br>org<span class="hljs-regexp">/example/</span>TestDemo	pMethod	(Ljava<span class="hljs-regexp">/lang/</span>String;)Ljava<span class="hljs-regexp">/lang/</span>String;	org<span class="hljs-regexp">/example/</span>TestDemo	cMethod	(Ljava<span class="hljs-regexp">/lang/</span>String;)Ljava<span class="hljs-regexp">/lang/</span>String;	<span class="hljs-number">1</span>		<span class="hljs-number">1</span><br>org<span class="hljs-regexp">/example/</span>TestDemo	pMethod	(Ljava<span class="hljs-regexp">/lang/</span>String;)Ljava<span class="hljs-regexp">/lang/</span>String;	org<span class="hljs-regexp">/example/</span>TestDemo	cMethod	(Ljava<span class="hljs-regexp">/lang/</span>String;)Ljava<span class="hljs-regexp">/lang/</span>String;	<span class="hljs-number">0</span>		<span class="hljs-number">0</span><br>org<span class="hljs-regexp">/example/</span>TestDemo	cMethod	(Ljava<span class="hljs-regexp">/lang/</span>String;)Ljava<span class="hljs-regexp">/lang/</span>String;	java<span class="hljs-regexp">/lang/</span>String	toUpperCase	()Ljava<span class="hljs-regexp">/lang/</span>String;	<span class="hljs-number">1</span>		<span class="hljs-number">0</span><br>org<span class="hljs-regexp">/example/</span>FnCompose	&lt;init&gt;	(Lorg<span class="hljs-regexp">/example/I</span>Fn;Lorg<span class="hljs-regexp">/example/I</span>Fn;)V	java<span class="hljs-regexp">/lang/</span>Object	&lt;init&gt;	()V	<span class="hljs-number">0</span>		<span class="hljs-number">0</span><br>org<span class="hljs-regexp">/example/m</span>odel<span class="hljs-regexp">/AbstractTableModel	&lt;init&gt;	(Ljava/u</span>til<span class="hljs-regexp">/HashMap;)V	java/</span>lang/Object	&lt;init&gt;	()V	<span class="hljs-number">0</span>		<span class="hljs-number">0</span><br>org<span class="hljs-regexp">/example/</span>FnEval	invokeCall	(Ljava<span class="hljs-regexp">/lang/</span>Object;)Ljava<span class="hljs-regexp">/lang/</span>Object;	java<span class="hljs-regexp">/lang/</span><span class="hljs-keyword">Runtime</span>	exec	(Ljava<span class="hljs-regexp">/lang/</span>String;)Ljava<span class="hljs-regexp">/lang/</span>Process;	<span class="hljs-number">1</span>		<span class="hljs-number">1</span><br>org<span class="hljs-regexp">/example/</span>FnCompose	invokeCall	(Ljava<span class="hljs-regexp">/lang/</span>Object;)Ljava<span class="hljs-regexp">/lang/</span>Object;	org<span class="hljs-regexp">/example/I</span>Fn	invokeCall	(Ljava<span class="hljs-regexp">/lang/</span>Object;)Ljava<span class="hljs-regexp">/lang/</span>Object;	<span class="hljs-number">1</span>		<span class="hljs-number">1</span><br>org<span class="hljs-regexp">/example/m</span>odel<span class="hljs-regexp">/AbstractTableModel	hashCode	()I	java/u</span>til<span class="hljs-regexp">/HashMap	get	(Ljava/</span>lang<span class="hljs-regexp">/Object;)Ljava/</span>lang/Object;	<span class="hljs-number">0</span>	__clojureFnMap	<span class="hljs-number">0</span><br>org<span class="hljs-regexp">/example/</span>TestDemo	&lt;init&gt;	()V	java<span class="hljs-regexp">/lang/</span>Object	&lt;init&gt;	()V	<span class="hljs-number">0</span>		<span class="hljs-number">0</span><br>org<span class="hljs-regexp">/example/</span>FnCompose	invokeCall	(Ljava<span class="hljs-regexp">/lang/</span>Object;)Ljava<span class="hljs-regexp">/lang/</span>Object;	org<span class="hljs-regexp">/example/I</span>Fn	invokeCall	(Ljava<span class="hljs-regexp">/lang/</span>Object;)Ljava<span class="hljs-regexp">/lang/</span>Object;	<span class="hljs-number">0</span>	f2	<span class="hljs-number">0</span><br>org<span class="hljs-regexp">/example/</span>FnCompose	invokeCall	(Ljava<span class="hljs-regexp">/lang/</span>Object;)Ljava<span class="hljs-regexp">/lang/</span>Object;	org<span class="hljs-regexp">/example/I</span>Fn	invokeCall	(Ljava<span class="hljs-regexp">/lang/</span>Object;)Ljava<span class="hljs-regexp">/lang/</span>Object;	<span class="hljs-number">0</span>	f1	<span class="hljs-number">0</span><br>org<span class="hljs-regexp">/example/</span>FnEval	&lt;init&gt;	()V	java<span class="hljs-regexp">/lang/</span>Object	&lt;init&gt;	()V	<span class="hljs-number">0</span>		<span class="hljs-number">0</span><br>org<span class="hljs-regexp">/example/m</span>odel<span class="hljs-regexp">/AbstractTableModel	hashCode	()I	org/</span>example<span class="hljs-regexp">/IFn	invokeCall	(Ljava/</span>lang<span class="hljs-regexp">/Object;)Ljava/</span>lang/Object;	<span class="hljs-number">0</span>		<span class="hljs-number">1</span><br>org<span class="hljs-regexp">/example/</span>FnConstant	&lt;init&gt;	(Ljava<span class="hljs-regexp">/lang/</span>Object;)V	java<span class="hljs-regexp">/lang/</span>Object	&lt;init&gt;	()V	<span class="hljs-number">0</span>		<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<p>4ã€æœç´¢å¯ç”¨çš„sourceï¼Œè¾“å‡ºä¿¡æ¯æ–‡ä»¶sources.dat</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">org<span class="hljs-regexp">/example/m</span>odel/AbstractTableModel	hashCode	()I	<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<p>5ã€æœç´¢ç”Ÿæˆè°ƒç”¨é“¾ï¼Œè¾“å‡ºç»“æœæ–‡ä»¶gadget-chains.txt</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">org/apache/log4j/pattern/LogEvent.readObject(Ljava/io/ObjectInputStream;)V (1)<br>  org/apache/log4j/pattern/LogEvent.readLevel(Ljava/io/ObjectInputStream;)V (1)<br>  java/lang/reflect/Method.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object; (0)<br><br>org/apache/log4j/spi/LoggingEvent.readObject(Ljava/io/ObjectInputStream;)V (1)<br>  org/apache/log4j/spi/LoggingEvent.readLevel(Ljava/io/ObjectInputStream;)V (1)<br>  java/lang/reflect/Method.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object; (0)<br><br>//æœ€ç»ˆç”Ÿæˆçš„ååºåˆ—åŒ–é“¾<br>org/example/model/AbstractTableModel.hashCode()I (0)<br>  org/example/FnEval.invokeCall(Ljava/lang/Object;)Ljava/lang/Object; (1)<br>  java/lang/Runtime.<span class="hljs-built_in">exec</span>(Ljava/lang/String;)Ljava/lang/Process; (1)<br><br></code></pre></td></tr></table></figure>

<p><img src="/img/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/46.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="4ã€æ€»ç»“"><a href="#4ã€æ€»ç»“" class="headerlink" title="4ã€æ€»ç»“"></a>4ã€æ€»ç»“</h2><p>åœ¨èŠ±äº†å‡ å‘¨æ—¶é—´åˆ†æå®Œè¯¥é¡¹ç›®åï¼Œå¯¹äºåˆ©ç”¨ASMæŠ€æœ¯ã€JVMæŒ‡ä»¤ã€æ¨¡æ‹Ÿæ ˆè°ƒç”¨ç­‰è§£å†³é™æ€æ‰«æçš„é—®é¢˜æœ‰äº†ä¸€äº›è®¤çŸ¥äº†è§£ã€‚å½“ç„¶åœ¨åˆ†æè¿‡ç¨‹ä¸­ä¹Ÿå‘ç°è¯¥å·¥å…·çš„ä¸€äº›å¼Šç«¯æˆ–è€…è¯´æ˜¯bugï¼Œå¦‚Transientä¿®é¥°å­—æ®µå¤„ç†é€»è¾‘ã€å¹¿åº¦ä¼˜å…ˆçš„æœç´¢ç­–ç•¥ã€sourceæº&#x2F;sinkæºä¸å®Œå–„ç­‰é—®é¢˜ã€‚è€Œææ¸…æ¥šé—®é¢˜ä¹‹åä¸‹ä¸€æ­¥å°±æ˜¯è§£å†³é—®é¢˜ã€å®Œå–„ä»£ç é€»è¾‘ã€‚å¦å¤–GadgetInspectorç›´æ¥åˆ†æwar&#x2F;jarçš„æ–¹å¼æ¯”è¾ƒè´´åˆå¹³æ—¶åšæ¼æ´æŒ–æ˜çš„å·¥ä½œåœºæ™¯ï¼Œå¦‚åœ¨ä¸€çº¿æ”»é˜²æ¼”ç»ƒæ—¶æ‹¿åˆ°äº†java waråŒ…ï¼Œç”±äºé¡¹ç›®å‘¨æœŸçŸ­ å¯èƒ½æ€¥éœ€ä¸€ä¸ªç‚¹æ’•å¼€é˜²å®ˆçš„å£å­ï¼Œè¿™æ—¶å€™æ‰«æå·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿåšä¸€äº›åŸºç¡€åˆ†æçš„å·¥ä½œï¼ŒåŸºäºæˆ‘ä»¬æå‰æŒ‡å®šçš„sourceæºã€sinkæ¼æ´ç‚¹åˆ†ææ‹¿åˆ°é¡¹ç›®çš„æ‰€æœ‰è·¯ç”±ã€å¯èƒ½å­˜åœ¨çš„æ”»å‡»é“¾è·¯ï¼Œè€Œå…·ä½“æ¼æ´EXPåˆ©ç”¨çš„æ„é€ äº¤ç»™æˆ‘ä»¬è‡ªå·±ã€‚ç›¸ä¿¡éšç€è§„åˆ™çš„å®Œå–„ï¼Œä¹Ÿä¼šå¾ˆå¤§çš„è¾…åŠ©å¢å¼ºæˆ‘ä»¬å®¡è®¡æŒ–æ˜çš„æ•ˆç‡ã€‚æ‰€ä»¥åœ¨å®Œå–„gadgetçš„æ‰«æé€»è¾‘åä¹Ÿè€ƒè™‘åŸºäºæ­¤å·¥å…·äºŒå¼€ä»¥ç®€åŒ–å¹³æ—¶ä¸€äº›å¸¸è§„æ¼æ´çš„æŒ–æ˜å®¡è®¡å·¥ä½œã€‚å†™åˆ°è¿™é‡Œ æˆæ–‡å·²ç»åˆè‡­åˆé•¿ï¼Œä¸å†èµ˜è¿°äº†ã€‚ä¸‹ä¸€æ­¥çš„todo-listå°±æ˜¯ç€é‡ä»£ç é€»è¾‘å®Œå–„ã€è§„åˆ™ä¼˜åŒ–ã€å¸¸è§„æ¼æ´æŒ–æ˜ç­‰ç›¸å…³é—®é¢˜ã€‚å®‰å…¨è·¯æ¼«æ¼«~</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E8%87%AA%E5%8A%A8%E5%8C%96%E5%AE%A1%E8%AE%A1/" class="category-chain-item">è‡ªåŠ¨åŒ–å®¡è®¡</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/JavaSec/">#JavaSec</a>
      
        <a href="/tags/%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90/">#é™æ€åˆ†æ</a>
      
        <a href="/tags/GadgetInspector/">#GadgetInspector</a>
      
        <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E5%AE%A1%E8%AE%A1/">#è‡ªåŠ¨åŒ–å®¡è®¡</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>é™æ€ä»£ç æ‰«æå·¥å…·ä¹‹GadgetInspectoræ¢ç©¶</div>
      <div>https://pwnull.github.io/2023/Research-on-GadgetInspector-of-Static-Code-Scanning-Tool/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>pwnull</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2023å¹´2æœˆ28æ—¥</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>è®¸å¯åè®®</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/From-apache-httpd-ssrf-cve-2021-40438-to-Rce/" title="ä»HTTPD-SSRF CVE-2021-40438èµ·æ‰‹çš„RCEæ¼æ´æŒ–æ˜">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ä»HTTPD-SSRF CVE-2021-40438èµ·æ‰‹çš„RCEæ¼æ´æŒ–æ˜</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/Research-VMware-vRealize-Log-Insight-CVE-vulnerability/" title="VMware-vRealize-Log-Insight-CVEæ¼æ´è¿½è¸ª">
                        <span class="hidden-mobile">VMware-vRealize-Log-Insight-CVEæ¼æ´è¿½è¸ª</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
      @pwnull
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
